<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Community Health Toolkit â€“ Contributing CHT Core Code</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/</link><description>Recent content in Contributing CHT Core Code on Community Health Toolkit</description><generator>Hugo -- gohugo.io</generator><language>en</language><atom:link href="https://docs.communityhealthtoolkit.org/community/contributing/code/core/index.xml" rel="self" type="application/rss+xml"/><item><title>CHT Core dev environment setup</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/dev-environment/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/dev-environment/</guid><description>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-rounded-lg hx-border hx-py-2 ltr:hx-pr-4 rtl:hx-pl-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300">
&lt;div class="ltr:hx-pl-3 ltr:hx-pr-2 rtl:hx-pr-3 rtl:hx-pl-2">&lt;/div>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>This guide assumes you are a CHT Core developer wanting to run the CHT Core from source code to make commits to the &lt;a href="https://github.com/medic/cht-core" target="_blank" rel="noopener">public GitHub repository&lt;/a>. To set up your environment for developing apps, see the &lt;a href="https://docs.communityhealthtoolkit.org/hosting/3.x/app-developer/" >app guide&lt;/a>.&lt;/p>
&lt;p>To deploy the CHT in production, see either &lt;a href="https://docs.communityhealthtoolkit.org/hosting/3.x/ec2-setup-guide/" >AWS hosting&lt;/a> or &lt;a href="https://docs.communityhealthtoolkit.org/hosting/3.x/self-hosting/" >Self hosting&lt;/a>.&lt;/p>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-indigo-200 hx-bg-indigo-100 hx-text-indigo-900 dark:hx-border-indigo-200/30 dark:hx-bg-indigo-900/30 dark:hx-text-indigo-200">
&lt;p class="hx-flex hx-items-center hx-font-medium">&lt;svg height=16px class="hx-inline-block hx-align-middle hx-mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>&lt;/svg>Important&lt;/p>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>These steps apply to both 3.x and 4.x CHT core development, unless stated otherwise.&lt;/p>&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2>The Happy Path Installation&lt;span class="hx-absolute -hx-mt-20" id="the-happy-path-installation">&lt;/span>
&lt;a href="#the-happy-path-installation" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>CHT Core development can be done on Linux, macOS, or Windows (using the &lt;a href="https://learn.microsoft.com/en-us/windows/wsl/install" target="_blank" rel="noopener">Windows Subsystem for Linux (WSL2)&lt;/a>). This CHT Core developer guide will have you install NodeJS, npm, and CouchDB (via Docker) on your local workstation.&lt;/p>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-green-200 hx-bg-green-100 hx-text-green-900 dark:hx-border-green-200/30 dark:hx-bg-green-900/30 dark:hx-text-green-200">
&lt;p class="hx-flex hx-items-center hx-font-medium">&lt;svg height=16px class="hx-inline-block hx-align-middle hx-mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>&lt;/svg>Tip&lt;/p>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>Ensure you have at least 8GB RAM, 50GB Free disk and 4 cores. However, more is for sure better here - you&amp;rsquo;ll see real speed improvements with more RAM and more cores.&lt;/p>&lt;/div>
&lt;/div>
&lt;/div>
&lt;h3>Install NodeJS, npm, and Docker&lt;span class="hx-absolute -hx-mt-20" id="install-nodejs-npm-and-docker">&lt;/span>
&lt;a href="#install-nodejs-npm-and-docker" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>First, update your current packages and install some supporting tools:&lt;/p>
&lt;p>&lt;em>(Node 22 is the environment used to run the CHT server in production, so this is the recommended version of Node to use for development.)&lt;/em>&lt;/p>
&lt;div class="hextra-scrollbar hx-overflow-x-auto hx-overflow-y-hidden hx-overscroll-x-contain">
&lt;div class="hx-mt-4 hx-flex hx-w-max hx-min-w-full hx-border-b hx-border-gray-200 hx-pb-px dark:hx-border-neutral-800">&lt;button
class="hextra-tabs-toggle data-[state=selected]:hx-border-primary-500 data-[state=selected]:hx-text-primary-600 data-[state=selected]:dark:hx-border-primary-500 data-[state=selected]:dark:hx-text-primary-600 hx-mr-2 hx-rounded-t hx-p-2 hx-font-medium hx-leading-5 hx-transition-colors -hx-mb-0.5 hx-select-none hx-border-b-2 hx-border-transparent hx-text-gray-600 hover:hx-border-gray-200 hover:hx-text-black dark:hx-text-gray-200 dark:hover:hx-border-neutral-800 dark:hover:hx-text-white"
role="tab"
type="button"
aria-controls="tabs-panel-0" aria-selected="true" tabindex="0" data-state="selected">Linux (Ubuntu)&lt;/button>&lt;button
class="hextra-tabs-toggle data-[state=selected]:hx-border-primary-500 data-[state=selected]:hx-text-primary-600 data-[state=selected]:dark:hx-border-primary-500 data-[state=selected]:dark:hx-text-primary-600 hx-mr-2 hx-rounded-t hx-p-2 hx-font-medium hx-leading-5 hx-transition-colors -hx-mb-0.5 hx-select-none hx-border-b-2 hx-border-transparent hx-text-gray-600 hover:hx-border-gray-200 hover:hx-text-black dark:hx-text-gray-200 dark:hover:hx-border-neutral-800 dark:hover:hx-text-white"
role="tab"
type="button"
aria-controls="tabs-panel-1">macOS&lt;/button>&lt;button
class="hextra-tabs-toggle data-[state=selected]:hx-border-primary-500 data-[state=selected]:hx-text-primary-600 data-[state=selected]:dark:hx-border-primary-500 data-[state=selected]:dark:hx-text-primary-600 hx-mr-2 hx-rounded-t hx-p-2 hx-font-medium hx-leading-5 hx-transition-colors -hx-mb-0.5 hx-select-none hx-border-b-2 hx-border-transparent hx-text-gray-600 hover:hx-border-gray-200 hover:hx-text-black dark:hx-text-gray-200 dark:hover:hx-border-neutral-800 dark:hover:hx-text-white"
role="tab"
type="button"
aria-controls="tabs-panel-2">Windows (WSL2)&lt;/button>&lt;/div>
&lt;/div>
&lt;div>
&lt;div
class="hextra-tabs-panel hx-rounded hx-pt-6 hx-hidden data-[state=selected]:hx-block"
id="tabs-panel-0"
role="tabpanel" tabindex="0" data-state="selected" >&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt update &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sudo apt -y dist-upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt -y install xsltproc curl uidmap jq python3 git make g++
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Use NVM to install NodeJS:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">nvm_version&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>curl -s https://api.github.com/repos/nvm-sh/nvm/releases/latest &lt;span class="p">|&lt;/span> jq -r .name&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/&lt;span class="nv">$nvm_version&lt;/span>/install.sh &lt;span class="p">|&lt;/span> &lt;span class="nv">$SHELL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nvm install &lt;span class="m">22&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div
class="hextra-tabs-panel hx-rounded hx-pt-6 hx-hidden data-[state=selected]:hx-block"
id="tabs-panel-1"
role="tabpanel">&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Uses Homebrew: https://brew.sh/&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">brew update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">brew install curl jq pyenv git make node@22 gcc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Python no longer included by default in macOS &amp;gt;12.3 &lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pyenv install 2.7.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">pyenv global 2.7.18
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;eval \&amp;#34;\$(pyenv init --path)\&amp;#34;&amp;#34;&lt;/span> &amp;gt;&amp;gt; ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div
class="hextra-tabs-panel hx-rounded hx-pt-6 hx-hidden data-[state=selected]:hx-block"
id="tabs-panel-2"
role="tabpanel">&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt update &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sudo apt -y dist-upgrade
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo apt -y install xsltproc curl uidmap jq python2 git make g++
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Use NVM to install NodeJS:&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">nvm_version&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="sb">`&lt;/span>curl -s https://api.github.com/repos/nvm-sh/nvm/releases/latest &lt;span class="p">|&lt;/span> jq -r .name&lt;span class="sb">`&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/&lt;span class="nv">$nvm_version&lt;/span>/install.sh &lt;span class="p">|&lt;/span> &lt;span class="nv">$SHELL&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">nvm install &lt;span class="m">22&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Now let&amp;rsquo;s ensure NodeJS 22 and npm 10 were installed. This should output version 22.x.x for NodeJS and 10.x.x for &lt;code>npm&lt;/code>:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">node -v &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> npm -v&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Install Docker:&lt;/p>
&lt;div class="hextra-scrollbar hx-overflow-x-auto hx-overflow-y-hidden hx-overscroll-x-contain">
&lt;div class="hx-mt-4 hx-flex hx-w-max hx-min-w-full hx-border-b hx-border-gray-200 hx-pb-px dark:hx-border-neutral-800">&lt;button
class="hextra-tabs-toggle data-[state=selected]:hx-border-primary-500 data-[state=selected]:hx-text-primary-600 data-[state=selected]:dark:hx-border-primary-500 data-[state=selected]:dark:hx-text-primary-600 hx-mr-2 hx-rounded-t hx-p-2 hx-font-medium hx-leading-5 hx-transition-colors -hx-mb-0.5 hx-select-none hx-border-b-2 hx-border-transparent hx-text-gray-600 hover:hx-border-gray-200 hover:hx-text-black dark:hx-text-gray-200 dark:hover:hx-border-neutral-800 dark:hover:hx-text-white"
role="tab"
type="button"
aria-controls="tabs-panel-0" aria-selected="true" tabindex="0" data-state="selected">Linux (Ubuntu)&lt;/button>&lt;button
class="hextra-tabs-toggle data-[state=selected]:hx-border-primary-500 data-[state=selected]:hx-text-primary-600 data-[state=selected]:dark:hx-border-primary-500 data-[state=selected]:dark:hx-text-primary-600 hx-mr-2 hx-rounded-t hx-p-2 hx-font-medium hx-leading-5 hx-transition-colors -hx-mb-0.5 hx-select-none hx-border-b-2 hx-border-transparent hx-text-gray-600 hover:hx-border-gray-200 hover:hx-text-black dark:hx-text-gray-200 dark:hover:hx-border-neutral-800 dark:hover:hx-text-white"
role="tab"
type="button"
aria-controls="tabs-panel-1">macOS&lt;/button>&lt;button
class="hextra-tabs-toggle data-[state=selected]:hx-border-primary-500 data-[state=selected]:hx-text-primary-600 data-[state=selected]:dark:hx-border-primary-500 data-[state=selected]:dark:hx-text-primary-600 hx-mr-2 hx-rounded-t hx-p-2 hx-font-medium hx-leading-5 hx-transition-colors -hx-mb-0.5 hx-select-none hx-border-b-2 hx-border-transparent hx-text-gray-600 hover:hx-border-gray-200 hover:hx-text-black dark:hx-text-gray-200 dark:hover:hx-border-neutral-800 dark:hover:hx-text-white"
role="tab"
type="button"
aria-controls="tabs-panel-2">Windows (WSL2)&lt;/button>&lt;/div>
&lt;/div>
&lt;div>
&lt;div
class="hextra-tabs-panel hx-rounded hx-pt-6 hx-hidden data-[state=selected]:hx-block"
id="tabs-panel-0"
role="tabpanel" tabindex="0" data-state="selected" >&lt;p>Download and install &lt;a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop&lt;/a>.&lt;/p>
&lt;p>Alternatively, on Linux you can use the following commands to install &lt;a href="https://docs.docker.com/engine/" target="_blank" rel="noopener">Docker Engine&lt;/a>. (This will reduce the layers of technical abstraction for running containers, but will not include a GUI application for managing your Docker resources.)&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">curl -fsSL get.docker.com -o get-docker.sh &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> sh get-docker.sh
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># OPTIONAL: Allow user to run Docker without sudo&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">dockerd-rootless-setuptool.sh install
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;export PATH=/usr/bin:&lt;/span>&lt;span class="nv">$PATH&lt;/span>&lt;span class="s2">&amp;#34;&lt;/span> &amp;gt;&amp;gt; ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;export DOCKER_HOST=unix:///run/user/1000/docker.sock&amp;#34;&lt;/span> &amp;gt;&amp;gt; ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/div>
&lt;div
class="hextra-tabs-panel hx-rounded hx-pt-6 hx-hidden data-[state=selected]:hx-block"
id="tabs-panel-1"
role="tabpanel">Download and install &lt;a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop&lt;/a> or &lt;a href="https://github.com/abiosoft/colima#readme" target="_blank" rel="noopener">Colima&lt;/a>.&lt;/div>
&lt;div
class="hextra-tabs-panel hx-rounded hx-pt-6 hx-hidden data-[state=selected]:hx-block"
id="tabs-panel-2"
role="tabpanel">Download and install &lt;a href="https://www.docker.com/products/docker-desktop" target="_blank" rel="noopener">Docker Desktop&lt;/a>.&lt;/div>
&lt;/div>
&lt;p>Restart your entire machine to finish initializing Docker.&lt;/p>
&lt;p>After restarting, verify Docker is running as expected. Run the simple &lt;code>hello-world&lt;/code> Docker container. This should output &amp;ldquo;Hello from Docker!&amp;rdquo; as well as some other intro text:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run hello-world&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>CHT Core Cloning and Setup&lt;span class="hx-absolute -hx-mt-20" id="cht-core-cloning-and-setup">&lt;/span>
&lt;a href="#cht-core-cloning-and-setup" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Clone the main CHT Core repo from GitHub and change directories into it:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">git clone https://github.com/medic/cht-core ~/cht-core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/cht-core&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Install dependencies and perform other setup tasks via an &lt;code>npm&lt;/code> command. Note this command may take many minutes. Be patient!&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">npm ci&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>To finalise setting up any remaining dependencies build the project by running:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">npm run build-dev&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Every time you run any &lt;code>npm&lt;/code> or &lt;code>node&lt;/code> commands, it will expect &lt;code>COUCH_NODE_NAME&lt;/code> and &lt;code>COUCH_URL&lt;/code> environment variables to be set:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;export COUCH_NODE_NAME=nonode@nohost&amp;#34;&lt;/span>&amp;gt;&amp;gt; ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="s2">&amp;#34;export COUCH_URL=http://medic:password@localhost:5984/medic&amp;#34;&lt;/span>&amp;gt;&amp;gt; ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">. ~/.&lt;span class="k">$(&lt;/span>basename &lt;span class="nv">$SHELL&lt;/span>&lt;span class="k">)&lt;/span>rc&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>To ensure these to exports and sourcing your rc file worked, echo the values back out. You should see &lt;code>nonode@nohost&lt;/code> and &lt;code>http://medic:password@localhost:5984/medic&lt;/code>:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">echo&lt;/span> &lt;span class="nv">$COUCH_NODE_NAME&lt;/span> &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">echo&lt;/span> &lt;span class="nv">$COUCH_URL&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>CouchDB&lt;span class="hx-absolute -hx-mt-20" id="couchdb">&lt;/span>
&lt;a href="#couchdb" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Create a &lt;code>docker-compose.yml&lt;/code> and &lt;code>couchdb-override.yml&lt;/code> files under the &lt;code>~/cht-docker&lt;/code> folder with this code:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">mkdir -p ~/cht-docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">curl -s -o ~/cht-docker/docker-compose.yml https://staging.dev.medicmobile.org/_couch/builds_4/medic:medic:master/docker-compose/cht-couchdb.yml
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">cat &amp;gt; ~/cht-docker/couchdb-override.yml &lt;span class="s">&amp;lt;&amp;lt; EOF
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">services:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> couchdb:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> ports:
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> - &amp;#34;5984:5984&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s"> - &amp;#34;5986:5986&amp;#34;
&lt;/span>&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="s">EOF&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Now you can start CouchDB. The login for your CHT instance will be &lt;code>medic&lt;/code> and the &lt;code>password&lt;/code> will be password:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/cht-docker
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nv">COUCHDB_USER&lt;/span>&lt;span class="o">=&lt;/span>medic &lt;span class="nv">COUCHDB_PASSWORD&lt;/span>&lt;span class="o">=&lt;/span>password docker compose -f docker-compose.yml -f couchdb-override.yml up -d&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>Developing&lt;span class="hx-absolute -hx-mt-20" id="developing">&lt;/span>
&lt;a href="#developing" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Now you have everything installed and can begin development! You&amp;rsquo;ll need three separate terminals when doing development.&lt;/p>
&lt;p>In the first terminal we&amp;rsquo;ll compile and deploy the web application by running:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/cht-core &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> npm run build-dev-watch&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Be &lt;strong>very&lt;/strong> patient until you see:&lt;/p>
&lt;blockquote>
&lt;p>&amp;ldquo;Waiting&amp;hellip;&amp;rdquo;&lt;/p>
&lt;/blockquote>
&lt;p>In the second terminal we&amp;rsquo;ll start the API nodejs service by running:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/cht-core &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> npm run dev-api&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Finally, in a 3rd terminal we&amp;rsquo;ll start the Sentinel nodejs service by running:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">cd&lt;/span> ~/cht-core &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> npm run dev-sentinel&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>That&amp;rsquo;s it! Now when you edit code in your IDE, it will automatically reload. You can see the CHT running locally here: &lt;a href="http://localhost:5988/" target="_blank" rel="noopener">http://localhost:5988/&lt;/a>&lt;/p>
&lt;p>When you&amp;rsquo;re done with development you can &lt;code>ctrl + c&lt;/code> in the three terminals and stop the CouchDB container with &lt;code>docker stop medic-couchdb&lt;/code>. When you want to resume development later, run &lt;code>docker start medic-couchdb&lt;/code> and re-run the three terminal commands.&lt;/p>
&lt;h2>Other Path Troubleshooting&lt;span class="hx-absolute -hx-mt-20" id="other-path-troubleshooting">&lt;/span>
&lt;a href="#other-path-troubleshooting" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>If you weren&amp;rsquo;t able to follow &lt;a href="#the-happy-path-installation" >the happy path above&lt;/a>, here are some details about the developer install that may help you troubleshoot what went wrong.&lt;/p>
&lt;h3>Prerequisites&lt;span class="hx-absolute -hx-mt-20" id="prerequisites">&lt;/span>
&lt;a href="#prerequisites" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>If you had issues with following the above steps, check out these links for how to install the prerequisites on your specific platform:&lt;/p>
&lt;ul>
&lt;li>&lt;a href="https://nodejs.org/" target="_blank" rel="noopener">Node.js 22.x&lt;/a> &amp;amp; &lt;a href="https://npmjs.com/" target="_blank" rel="noopener">npm 10.x.x&lt;/a> - Both of which we recommend installing &lt;a href="https://github.com/nvm-sh/nvm#installing-and-updating" target="_blank" rel="noopener">via &lt;code>nvm&lt;/code>&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://github.com/ilyar/xsltproc" target="_blank" rel="noopener">xsltproc&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://www.python.org/downloads/" target="_blank" rel="noopener">python 2.7&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.docker.com/engine/install/" target="_blank" rel="noopener">Docker&lt;/a>&lt;/li>
&lt;li>&lt;a href="https://docs.couchdb.org/en/stable/install/index.html" target="_blank" rel="noopener">CouchDB&lt;/a> - OS package instead of in Docker - you &lt;strong>MUST&lt;/strong> use CouchDB 2.x for CHT &amp;lt; 4.4! We still strongly recommend using Docker.&lt;/li>
&lt;li>[bzip2])(&lt;a href="https://sourceware.org/bzip2/downloads.html" target="_blank" rel="noopener">https://sourceware.org/bzip2/downloads.html&lt;/a>) - if you&amp;rsquo;re on Ubuntu call: &lt;code>sudo apt install bzip2&lt;/code>&lt;/li>
&lt;/ul>
&lt;h3>Ubuntu 18.04&lt;span class="hx-absolute -hx-mt-20" id="ubuntu-1804">&lt;/span>
&lt;a href="#ubuntu-1804" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Ubuntu 18.04&amp;rsquo;s default &lt;code>apt&lt;/code> repositories do not know about &lt;code>python2&lt;/code>. This means when you go to install run the first &lt;code>apt install&lt;/code> command above, you see an error:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">E: Unable to locate package python2&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>To fix this, change the &lt;code>apt install&lt;/code> call to this:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo apt -y install xsltproc curl uidmap jq python git make g++&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>As well, after you install docker, and go to run the rootless script &lt;code>dockerd-rootless-setuptool.sh&lt;/code>, you might see this error:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="o">[&lt;/span>ERROR&lt;span class="o">]&lt;/span> Failed to start docker.service. Run &lt;span class="sb">`&lt;/span>journalctl -n &lt;span class="m">20&lt;/span> --no-pager --user --unit docker.service&lt;span class="sb">`&lt;/span> to show the error log.&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>The workaround, unfortunately, is to just start your CouchDB Docker container with sudo: &lt;code>sudo docker run...&lt;/code>.&lt;/p>
&lt;h3>CouchDB on Docker Details&lt;span class="hx-absolute -hx-mt-20" id="couchdb-on-docker-details">&lt;/span>
&lt;a href="#couchdb-on-docker-details" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Breaking down the command from &lt;a href="#couchdb" >the above section&lt;/a>, here&amp;rsquo;s a generic version that doesn&amp;rsquo;t include hard coded paths:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">docker run -d -p 5984:5984 -p 5986:5986 --name medic-couchdb -e &lt;span class="nv">COUCHDB_USER&lt;/span>&lt;span class="o">=&lt;/span>medic -e &lt;span class="nv">COUCHDB_PASSWORD&lt;/span>&lt;span class="o">=&lt;/span>password -v &amp;lt;data path&amp;gt;:/opt/couchdb/data -v &amp;lt;config path&amp;gt;:/opt/couchdb/etc/local.d apache/couchdb:2&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Parts of the command:&lt;/p>
&lt;ul>
&lt;li>&lt;code>--name&lt;/code> creates a container called &lt;code>medic-couchdb&lt;/code>. You can name it whatever you want, but this is how you refer to it later&lt;/li>
&lt;li>&lt;code>-e&lt;/code> sets an environment variable inside the container. Two are set here, for a user and password for the initial admin user.&lt;/li>
&lt;li>&lt;code>-v&lt;/code> maps where couchdb stores data to your local file system to ensure persistence without depending on the container, using the path &lt;em>before&lt;/em> the &lt;code>:&lt;/code> (the path after the colon is the internal path inside the docker image). This should be somewhere you have write access to, and want this data to be stored. The second mounted volume is for the couch configuration, which will retain settings if your container is removed. This is especially important after running the command to secure the instance (done in steps below).&lt;/li>
&lt;li>&lt;code>apache/couchdb:2&lt;/code> will install the latest package for CouchDB 2.x&lt;/li>
&lt;/ul>
&lt;p>Once this downloads and starts, you will need to &lt;a href="http://localhost:5984/_utils/#/setup" target="_blank" rel="noopener">initialise CouchDB&lt;/a> as noted in &lt;a href="https://docs.couchdb.org/en/stable/setup/index.html#setup" target="_blank" rel="noopener">their install instructions&lt;/a>.&lt;/p>
&lt;p>You can use &lt;code>docker stop medic-couchdb&lt;/code> to stop it and &lt;code>docker start medic-couchdb&lt;/code> to start it again. Remember that you&amp;rsquo;ll need to start it whenever you restart your OS, which might not be the case if you use a normal OS package. &lt;code>docker rm medic-couchdb&lt;/code> will totally remove the container.&lt;/p>
&lt;p>Medic recommends you familiarise yourself with other Docker commands to make docker image and container management clearer.&lt;/p>
&lt;h3>Required environment variables&lt;span class="hx-absolute -hx-mt-20" id="required-environment-variables">&lt;/span>
&lt;a href="#required-environment-variables" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Medic needs the following environment variables to be declared:&lt;/p>
&lt;ul>
&lt;li>&lt;code>COUCH_URL&lt;/code>: the full authenticated url to the &lt;code>medic&lt;/code> DB. Locally this would be &lt;code>http://medic:password@localhost:5984/medic&lt;/code>&lt;/li>
&lt;li>&lt;code>COUCH_NODE_NAME&lt;/code>: the name of your CouchDB&amp;rsquo;s node. The Docker image default is &lt;code>nonode@nohost&lt;/code>. Other installations may use &lt;code>couchdb@127.0.0.1&lt;/code>. You can find out by querying &lt;a href="https://docs.couchdb.org/en/stable/api/server/common.html#membership" target="_blank" rel="noopener">CouchDB&amp;rsquo;s membership API&lt;/a>&lt;/li>
&lt;li>(optional) &lt;code>COUCHDB_USER&lt;/code>: the name of your CouchDB&amp;rsquo;s user. The Docker image default is &lt;code>medic&lt;/code>&lt;/li>
&lt;li>(optional) &lt;code>COUCHDB_PASSWORD&lt;/code>: the credentials of your CouchDB user. The Docker image default is &lt;code>password&lt;/code>&lt;/li>
&lt;li>(optional) &lt;code>API_PORT&lt;/code>: the port API will run on. If not defined, the port defaults to &lt;code>5988&lt;/code>&lt;/li>
&lt;li>(optional) &lt;code>CHROME_BIN&lt;/code>: only required if tests complain that they can&amp;rsquo;t find Chrome or if you want to run a specific version of the Chrome webdriver.&lt;/li>
&lt;/ul>
&lt;p>How to permanently define environment variables depends on your OS and shell (e.g. for bash you can put them &lt;code>~/.bashrc&lt;/code>). You can temporarily define them with &lt;code>export&lt;/code>:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">COUCH_NODE_NAME&lt;/span>&lt;span class="o">=&lt;/span>nonode@nohost
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">COUCH_URL&lt;/span>&lt;span class="o">=&lt;/span>http://medic:password@localhost:5984/medic&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Tests&lt;span class="hx-absolute -hx-mt-20" id="tests">&lt;/span>
&lt;a href="#tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Refer to &lt;a href="https://github.com/medic/cht-core/blob/master/TESTING.md" target="_blank" rel="noopener">the testing doc&lt;/a> in the GitHub repo.&lt;/p>
&lt;h2>nginx-local-ip&lt;span class="hx-absolute -hx-mt-20" id="nginx-local-ip">&lt;/span>
&lt;a href="#nginx-local-ip" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;a href="https://github.com/medic/nginx-local-ip" target="_blank" rel="noopener">&lt;code>nginx-local-ip&lt;/code>&lt;/a> is a local proxy that keeps all traffic local, and runs without latency or throttling. If sharing your local CHT instance is not required, it is the recommended method to add a valid SSL certificate (rather than &lt;code>ngrok&lt;/code> or similar).&lt;/p>
&lt;ol>
&lt;li>Clone the repo: &lt;code>git clone https://github.com/medic/nginx-local-ip.git&lt;/code>&lt;/li>
&lt;li>&lt;code>cd&lt;/code> into the new directory: &lt;code>cd nginx-local-ip&lt;/code>&lt;/li>
&lt;li>Assuming your IP is &lt;code>192.168.0.3&lt;/code>, start &lt;code>nginx-local-ip&lt;/code> to connect to:
&lt;ul>
&lt;li>The CHT API running via &lt;code>npm run&lt;/code> or &lt;code>horti&lt;/code>, execute &lt;code>APP_URL=http://192.168.0.3:5988 docker compose up&lt;/code> and then access it at &lt;code>https://192-168-0-3.local-ip.medicmobile.org/&lt;/code>.&lt;/li>
&lt;li>The CHT API running via &lt;code>docker&lt;/code>, the ports are remapped, so execute &lt;code>HTTP=8080 HTTPS=8443 APP_URL=https://192.168.0.3 docker compose up&lt;/code> and then access it at &lt;code>https://192-168-0-3.local-ip.medicmobile.org:8443/&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>The HTTP/HTTPS ports (&lt;code>80&lt;/code>/&lt;code>443&lt;/code>) need to accept traffic from the IP address of your host machine and your local webapp port (e.g. &lt;code>5988&lt;/code>) needs to accept traffic from the IP address of the &lt;code>nginx-local-ip&lt;/code> container (on the Docker network). If you are using the UFW firewall (in a Linux environment) you can allow traffic on these ports with the following commands:&lt;/li>
&lt;/ol>
&lt;p>(Since local IP addresses can change over time, ranges are used in these rules so that the firewall configuration does not have to be updated each time a new address is assigned.)&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">sudo ufw allow proto tcp from 192.168.0.0/16 to any port 80,443
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">sudo ufw allow proto tcp from 172.16.0.0/16 to any port &lt;span class="m">5988&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Remote Proxies&lt;span class="hx-absolute -hx-mt-20" id="remote-proxies">&lt;/span>
&lt;a href="#remote-proxies" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>ngrok&lt;/code> and &lt;code>pagekite&lt;/code> are remote proxies that route local traffic between your client and the CHT via a remote SSL terminator. While easy and handy, they introduce latency and are sometimes throttled. Always use &lt;code>nginx-local-ip&lt;/code> when you need a TLS certificate and only use these when you need to share your dev instance.&lt;/p>
&lt;h3>ngrok&lt;span class="hx-absolute -hx-mt-20" id="ngrok">&lt;/span>
&lt;a href="#ngrok" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>Create an &lt;a href="https://ngrok.com/" target="_blank" rel="noopener">ngrok account&lt;/a>, download and install the binary, then link your computer to your ngrok account.&lt;/li>
&lt;li>Start &lt;code>ngrok&lt;/code> to connect to:
&lt;ul>
&lt;li>The CHT API running via &lt;code>npm run&lt;/code> or &lt;code>horti&lt;/code>, execute &lt;code>./ngrok http 5988&lt;/code>&lt;/li>
&lt;li>The CHT API running via &lt;code>docker&lt;/code>, execute &lt;code>./ngrok http 443&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Access the app using the https address shown (e.g. &lt;code>https://YOUR-NGROK-NAME.ngrok.io&lt;/code>, replacing &lt;code>YOUR-NGROK-NAME&lt;/code> with what you signed up with).&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>Note:&lt;/strong> The service worker cache preload sometimes fails due to connection throttling (thereby causing an &lt;code>ngrok&lt;/code> failure at startup).&lt;/p>
&lt;h3>pagekite&lt;span class="hx-absolute -hx-mt-20" id="pagekite">&lt;/span>
&lt;a href="#pagekite" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>Create a &lt;a href="https://pagekite.net/signup/" target="_blank" rel="noopener">pagekite account&lt;/a>, download and install the python script.&lt;/li>
&lt;li>Start pagekite (be sure to replace &lt;code>YOUR-PAGEKIT-NAME&lt;/code> with the URL you signed up for) to connect to:&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>The CHT API running via &lt;code>npm run&lt;/code> or &lt;code>horti&lt;/code>, execute &lt;code>python pagekite.py 5988 YOUR-PAGEKIT-NAME.pagekite.me&lt;/code>&lt;/li>
&lt;li>The CHT API running via &lt;code>docker&lt;/code>, execute &lt;code>python pagekite.py 443 YOUR-PAGEKIT-NAME.pagekite.me&lt;/code>&lt;/li>
&lt;/ul>
&lt;ol>
&lt;li>Access the app using the https address shown (e.g. &lt;code>https://YOUR-PAGEKIT-NAME.pagekite.me&lt;/code>).&lt;/li>
&lt;/ol></description></item><item><title>Build commands</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/build-commands/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/build-commands/</guid><description>
&lt;h2>CHT Core build commands&lt;span class="hx-absolute -hx-mt-20" id="cht-core-build-commands">&lt;/span>
&lt;a href="#cht-core-build-commands" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>These commands are defined in the &lt;code>package.json&lt;/code> and can be executed with &lt;code>npm run &amp;lt;command&amp;gt;&lt;/code> from the cht-core repository directory.&lt;/p>
&lt;h3>Development build commands&lt;span class="hx-absolute -hx-mt-20" id="development-build-commands">&lt;/span>
&lt;a href="#development-build-commands" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>For developers (humans) to execute to build &lt;code>cht-core&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Command&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>build-ddocs&lt;/code>&lt;/td>
&lt;td>Compiles all the DDocs and outputs them into &lt;code>/api/build/ddocs&lt;/code> ready for deployment.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>build-dev&lt;/code>&lt;/td>
&lt;td>Updates dependencies and builds all the applications.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>build-dev-watch&lt;/code>&lt;/td>
&lt;td>Same as &lt;code>build-dev&lt;/code>, but keeps watching for any code changes and automatically deploys on change.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>build-documentation&lt;/code>&lt;/td>
&lt;td>Executes jsdoc on all the applications.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>build-webapp-dev&lt;/code>&lt;/td>
&lt;td>Compiles the &lt;code>/webapp&lt;/code> application.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>build-cht-form&lt;/code>&lt;/td>
&lt;td>Compiles the &lt;code>cht-form&lt;/code> web component.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>copy-api-resources&lt;/code>&lt;/td>
&lt;td>Copies the static api files into the &lt;code>api&lt;/code> build directory ready for deployment.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>dev-api&lt;/code>&lt;/td>
&lt;td>Sets up and runs the &lt;code>api&lt;/code> server, and automatically deploys source changes.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>dev-sentinel&lt;/code>&lt;/td>
&lt;td>Sets up and runs the &lt;code>sentinel&lt;/code> server, and automatically deploys source changes.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>local-images&lt;/code>&lt;/td>
&lt;td>Builds the docker images and updates the docker compose files.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>update-service-worker&lt;/code>&lt;/td>
&lt;td>Updates the service worker file for deployment.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3>Development test commands&lt;span class="hx-absolute -hx-mt-20" id="development-test-commands">&lt;/span>
&lt;a href="#development-test-commands" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>For developers to execute to test &lt;code>cht-core&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Command&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>integration-all-local&lt;/code>&lt;/td>
&lt;td>Compiles the app and executes the integration test suite except for the sentinel tests.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>integration-api&lt;/code>&lt;/td>
&lt;td>Compiles the app and executes the api integration test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>integration-sentinel-local&lt;/code>&lt;/td>
&lt;td>Compiles the app and executes the sentinel integration test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>lint&lt;/code>&lt;/td>
&lt;td>Performs static analysis checks on the codebase.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>test&lt;/code>&lt;/td>
&lt;td>Same as running &lt;code>lint&lt;/code>, &lt;code>unit&lt;/code>, and &lt;code>integration-api&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit&lt;/code>&lt;/td>
&lt;td>Executes unit test suites for all applications.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit-admin&lt;/code>&lt;/td>
&lt;td>Executes the unit test suite on &lt;code>admin&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit-api&lt;/code>&lt;/td>
&lt;td>Executes the unit test suite on &lt;code>api&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit-sentinel&lt;/code>&lt;/td>
&lt;td>Executes the unit test suite on &lt;code>sentinel&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit-shared-lib&lt;/code>&lt;/td>
&lt;td>Executes the unit test suite on all &lt;code>shared-lib&lt;/code> modules.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit-webapp&lt;/code>&lt;/td>
&lt;td>Executes the unit test suite on &lt;code>webapp&lt;/code>.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>unit-webapp-continuous&lt;/code>&lt;/td>
&lt;td>Executes the unit test suite on &lt;code>webapp&lt;/code>, and re-runs on code change.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>wdio-default-mobile-local&lt;/code>&lt;/td>
&lt;td>Compiles the app and executes the mobile e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>wdio-local&lt;/code>&lt;/td>
&lt;td>Compiles the app and executes the default e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>wdio-standard-local&lt;/code>&lt;/td>
&lt;td>Compiles the app and executes the standard e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>wdio-cht-form&lt;/code>&lt;/td>
&lt;td>Executes the default e2e test suite on code change.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3>CI commands&lt;span class="hx-absolute -hx-mt-20" id="ci-commands">&lt;/span>
&lt;a href="#ci-commands" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>For Continuous Integration (robots) to run to build and test &lt;code>cht-core&lt;/code>.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Command&lt;/th>
&lt;th>Description&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>&lt;code>build&lt;/code>&lt;/td>
&lt;td>Compiles, minifies, bundles the code, and builds the DDocs for publishing.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>ci-compile&lt;/code>&lt;/td>
&lt;td>Builds, does static analysis, and runs unit tests for all applications.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>ci-e2e-integration&lt;/code>&lt;/td>
&lt;td>Executes the integration e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>ci-webdriver-default&lt;/code>&lt;/td>
&lt;td>Executes the default e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>ci-webdriver-default-mobile&lt;/code>&lt;/td>
&lt;td>Executes the mobile e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>ci-webdriver-standard&lt;/code>&lt;/td>
&lt;td>Executes the standard e2e test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>publish-for-testing&lt;/code>&lt;/td>
&lt;td>Builds docker images and publishes to the staging server for use in e2e test builds.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>test-config-default&lt;/code>&lt;/td>
&lt;td>Executes the default config test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>test-config-standard&lt;/code>&lt;/td>
&lt;td>Executes the standard config test suite.&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>&lt;code>upgrade-wdio&lt;/code>&lt;/td>
&lt;td>Executes the upgrade e2e test suite.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table></description></item><item><title>Update Dependencies</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/update-dependencies/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/update-dependencies/</guid><description>
&lt;p>Every minor release we update dependencies to get the latest fixes and improvements. We do this early in the release cycle so that we have some more time to find regressions and issues. This is done on all folders with a &lt;code>package-lock.json&lt;/code>, including:&lt;/p>
&lt;div class="hextra-filetree hx-mt-6 hx-select-none hx-text-sm hx-text-gray-800 dark:hx-text-gray-300 not-prose">
&lt;div class="hx-inline-block hx-rounded-lg hx-border hx-px-4 hx-py-2 dark:hx-border-neutral-800">
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">cht-core&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;li class="hx-flex hx-list-none">
&lt;span class="hx-inline-flex hx-cursor-default hx-items-center hx-py-1">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>&lt;/svg>&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">/(root)&lt;/span>
&lt;/span>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">admin&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;/ul>
&lt;/li>
&lt;li class="hx-group hx-flex hx-list-none hx-flex-col">
&lt;button class="hextra-filetree-folder hx-inline-flex hx-cursor-pointer hx-items-center hx-py-1 hover:hx-opacity-60">
&lt;span data-state="open" class="data-[state=open]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M3 7v10a2 2 0 002 2h14a2 2 0 002-2V9a2 2 0 00-2-2h-6l-2-2H5a2 2 0 00-2 2z"/>&lt;/svg>&lt;/span>
&lt;span data-state="open" class="data-[state=closed]:hx-hidden">&lt;svg width=1em xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"/>&lt;/svg>&lt;/span>
&lt;span class="ltr:hx-ml-1 rtl:hx-mr-1">webapp&lt;/span>
&lt;/button>
&lt;ul data-state="open" class="ltr:hx-pl-5 rtl:hx-pr-5 data-[state=closed]:hx-hidden">
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/div>
&lt;/div>
&lt;h2>Steps&lt;span class="hx-absolute -hx-mt-20" id="steps">&lt;/span>
&lt;a href="#steps" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ol>
&lt;li>Checkout and pull the latest default branch - get the latest code&lt;/li>
&lt;li>Make a branch: &lt;code>git checkout -b &amp;quot;&amp;lt;issue&amp;gt;-update-dependencies&amp;quot;&lt;/code>&lt;/li>
&lt;li>Take a look at the current &lt;a href="https://github.com/medic/cht-core/issues?q=is%3Aopen&amp;#43;is%3Aissue&amp;#43;label%3ADependencies" target="_blank" rel="noopener">list of dependencies related issues&lt;/a>, where you can find the latest conversations and information.&lt;/li>
&lt;/ol>
&lt;p>Then for each folder go through these steps.&lt;/p>
&lt;ol>
&lt;li>&lt;code>npm ci&lt;/code> - update your local node_modules to match expected&lt;/li>
&lt;li>&lt;code>npm outdated&lt;/code> - report on any dependencies which aren&amp;rsquo;t at the latest&lt;/li>
&lt;li>&lt;code>npm install --save[-dev] package@version&lt;/code> - install the latest version (be careful and read the release notes if the new version is a major change from the current)&lt;/li>
&lt;li>&lt;code>npm dedupe&lt;/code> - remove duplicated dependencies&lt;/li>
&lt;li>&lt;code>npm audit fix&lt;/code> - automatically fix any nested dependencies with vulnerabilities&lt;/li>
&lt;li>&lt;code>npm audit&lt;/code> - get a report on any remaining vulnerabilities and manually scan it to see if there&amp;rsquo;s anything else you can do&lt;/li>
&lt;/ol>
&lt;h2>Problems&lt;span class="hx-absolute -hx-mt-20" id="problems">&lt;/span>
&lt;a href="#problems" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>See &lt;a href="https://github.com/medic/cht-core/issues/9770" target="_blank" rel="noopener">issue #9770&lt;/a> for a list of the known dependencies that cannot be upgraded further because their latest versions only support ES Modules.&lt;/li>
&lt;li>Don&amp;rsquo;t update &lt;code>bootstrap&lt;/code> to 4+ as it has many breaking changes. One day we will either raise an issue to upgrade it or migrate off it, but that is outside the scope of this change.&lt;/li>
&lt;li>Don&amp;rsquo;t update &lt;code>bootstrap-daterangepicker&lt;/code>.&lt;/li>
&lt;li>Don&amp;rsquo;t update the &lt;code>webapp&lt;/code> version of &lt;code>jquery&lt;/code> to 3.6.0+ as the &lt;code>select2&lt;/code> search input loses focus on click event, this is a &lt;a href="https://github.com/select2/select2/issues/5993" target="_blank" rel="noopener">known issue&lt;/a> in their repository.
&lt;ul>
&lt;li>Note that the &lt;code>webapp&lt;/code> webpack config is aliasing the &lt;code>jquery&lt;/code> package to make sure we only bundle one version of jquery. Currently &lt;code>enketo-core&lt;/code> is targeting &lt;code>3.6.3&lt;/code>, but we cannot take that version because of this select2 issue.&lt;/li>
&lt;li>This select2 issue is actually resolved by upgrading to jquery &lt;code>3.7+&lt;/code>, but we cannot move to that version because it is not compatible with our current version of enketo-core (&lt;code>7.2.5&lt;/code>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>If you have trouble upgrading any other dependency and you think it&amp;rsquo;ll be challenging to fix it then raise a new issue with &lt;code>Dependencies&lt;/code> tag, to upgrade just that dependency. Don&amp;rsquo;t hold up all the other upgrades you&amp;rsquo;ve made.&lt;/li>
&lt;/ul>
&lt;h2>Troubleshooting&lt;span class="hx-absolute -hx-mt-20" id="troubleshooting">&lt;/span>
&lt;a href="#troubleshooting" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;details class="last-of-type:hx-mb-0 hx-rounded-lg hx-bg-neutral-50 dark:hx-bg-neutral-800 hx-p-2 hx-mt-4 hx-group" >
&lt;summary class="hx-flex hx-items-center hx-cursor-pointer hx-select-none hx-list-none hx-p-1 hx-rounded hx-transition-colors hover:hx-bg-gray-100 dark:hover:hx-bg-neutral-800 before:hx-mr-1 before:hx-inline-block before:hx-transition-transform before:hx-content-[''] dark:before:hx-invert rtl:before:hx-rotate-180 group-open:before:hx-rotate-90">
&lt;strong class="hx-text-lg">Angular exception&lt;/strong>
&lt;/summary>
&lt;div class="hx-p-2 hx-overflow-hidden">
&lt;p>When upgrading Webapp&amp;rsquo;s Angular, you might get the following exception:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;pre>&lt;code>Running &amp;#34;exec:build-webapp&amp;#34; (exec) task
________________________________________
An unhandled exception occurred: Class extends value undefined is not a constructor or null
see &amp;#34;/private/var/folders/tx/lskdwi/T/ng-23kdi/angular-errors.log&amp;#34; for further details.
&amp;gt;&amp;gt; Exited with code: 127&lt;/code>&lt;/pre>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>This error is thrown by the Webpack&amp;rsquo;s subresource integrity. It&amp;rsquo;s likely that &lt;code>@angular/compiler&lt;/code>, &lt;code>@angular-devkit/build-angular&lt;/code> or &lt;code>@angular-builders/custom-webpack&lt;/code> aren&amp;rsquo;t resolved properly in the &lt;code>package-lock.json&lt;/code>.&lt;/p>
&lt;p>To fix it, uninstall these 3 dependencies and then install them again in this order:&lt;/p>
&lt;ol>
&lt;li>&lt;code>@angular/compiler&lt;/code>&lt;/li>
&lt;li>&lt;code>@angular-devkit/build-angular&lt;/code>&lt;/li>
&lt;li>&lt;code>@angular-builders/custom-webpack&lt;/code>&lt;/li>
&lt;/ol>
&lt;p>If the error is still happening, try reinstalling &lt;code>@angular/cli&lt;/code>.&lt;/p>
&lt;/div>
&lt;/details>
&lt;details class="last-of-type:hx-mb-0 hx-rounded-lg hx-bg-neutral-50 dark:hx-bg-neutral-800 hx-p-2 hx-mt-4 hx-group" >
&lt;summary class="hx-flex hx-items-center hx-cursor-pointer hx-select-none hx-list-none hx-p-1 hx-rounded hx-transition-colors hover:hx-bg-gray-100 dark:hover:hx-bg-neutral-800 before:hx-mr-1 before:hx-inline-block before:hx-transition-transform before:hx-content-[''] dark:before:hx-invert rtl:before:hx-rotate-180 group-open:before:hx-rotate-90">
&lt;strong class="hx-text-lg">npm errno -17&lt;/strong>
&lt;/summary>
&lt;div class="hx-p-2 hx-overflow-hidden">
If &lt;code>npm ci&lt;/code> errors with &amp;ldquo;errno -17&amp;rdquo; in shared-libs you may need to manually remove the nested dependencies from the package-lock.json. This needs move investigation to work out why this is happening.
&lt;/div>
&lt;/details>
&lt;details class="last-of-type:hx-mb-0 hx-rounded-lg hx-bg-neutral-50 dark:hx-bg-neutral-800 hx-p-2 hx-mt-4 hx-group" >
&lt;summary class="hx-flex hx-items-center hx-cursor-pointer hx-select-none hx-list-none hx-p-1 hx-rounded hx-transition-colors hover:hx-bg-gray-100 dark:hover:hx-bg-neutral-800 before:hx-mr-1 before:hx-inline-block before:hx-transition-transform before:hx-content-[''] dark:before:hx-invert rtl:before:hx-rotate-180 group-open:before:hx-rotate-90">
&lt;strong class="hx-text-lg">select2 is not a function&lt;/strong>
&lt;/summary>
&lt;div class="hx-p-2 hx-overflow-hidden">
&lt;p>If you get &lt;code>TypeError: &amp;quot;$(...).select2 is not a function&amp;quot;&lt;/code> then either:&lt;/p>
&lt;ol>
&lt;li>You bumped select2. For some reason this breaks it.&lt;/li>
&lt;li>You have multiple jquery libraries and select2 is getting attached to one but not the other. Make sure the jquery versions in enketo-core and webapp match and you&amp;rsquo;ve &lt;code>run dedupe&lt;/code> to remove the enketo-core copy.&lt;/li>
&lt;/ol>
&lt;/div>
&lt;/details></description></item><item><title>Automated Tests</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/automated-tests/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/automated-tests/</guid><description>
&lt;h2>The goal of automated testing&lt;span class="hx-absolute -hx-mt-20" id="the-goal-of-automated-testing">&lt;/span>
&lt;a href="#the-goal-of-automated-testing" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Contributors from all backgrounds are welcome to make changes in the codebase. The CHT testing framework is designed to help you contribute with confidence, regardless of your experience level. This guide will help you understand the CHT testing approach and how you can contribute effectively.&lt;/p>
&lt;p>A key part of this confidence comes from knowing that new changes have not impacted other functionality in the system and everything continues to work as expected.
Automation of testing should speed up development in two significant areas:&lt;/p>
&lt;ol>
&lt;li>While making changes, new automated tests can be run regularly to ensure (without lots of manual effort) that the changes continue to work as expected&lt;/li>
&lt;li>Avoid large amounts of time spent manually performing regression testing of the whole application to ensure existing functionality keeps working&lt;/li>
&lt;/ol>
&lt;h2>Test types and expectations&lt;span class="hx-absolute -hx-mt-20" id="test-types-and-expectations">&lt;/span>
&lt;a href="#test-types-and-expectations" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>CHT Core contains three types of tests, each serving a specific purpose (ordered by levels low to high):&lt;/p>
&lt;ol>
&lt;li>Unit tests&lt;/li>
&lt;li>Integration tests
&lt;ul>
&lt;li>Backend integration tests&lt;/li>
&lt;li>Frontend integration tests&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>End-to-end tests&lt;/li>
&lt;/ol>
&lt;p>&lt;strong>Note:&lt;/strong> All the commands to execute the different tests can be found in &lt;a href="https://github.com/medic/cht-core/blob/master/package.json" target="_blank" rel="noopener">package.json&lt;/a> file.&lt;/p>
&lt;h2>Unit Tests&lt;span class="hx-absolute -hx-mt-20" id="unit-tests">&lt;/span>
&lt;a href="#unit-tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>Description&lt;span class="hx-absolute -hx-mt-20" id="description">&lt;/span>
&lt;a href="#description" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Small tests of specific behavior. Each unit test is only intended to validate an isolated piece (unit) of functionality separated from the rest of the system. Any dependencies are often mocked.
These are typically the easiest to write and are a great starting point for new contributors.&lt;/p>
&lt;p>&lt;strong>Write unit tests for:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>Testing individual functions or methods&lt;/li>
&lt;li>Verifying component behavior&lt;/li>
&lt;li>Checking edge cases&lt;/li>
&lt;/ul>
&lt;h3>Expectations&lt;span class="hx-absolute -hx-mt-20" id="expectations">&lt;/span>
&lt;a href="#expectations" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>High coverage of functionality. If measured in branch coverage percentage, aim for 100%. This is the place to guarantee confidence in the system. If a higher-level test spots and error and there&amp;rsquo;s no lower-level test failing, you should evaluate if a lower-level test should be written.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Execution Speed&lt;/th>
&lt;th>Complexity&lt;/th>
&lt;th>Fragility&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Extremely fast&lt;/td>
&lt;td>Extremely low&lt;/td>
&lt;td>Extremely stable&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3>Implementation&lt;span class="hx-absolute -hx-mt-20" id="implementation">&lt;/span>
&lt;a href="#implementation" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>In cht-core unit tests are located in the &lt;code>tests&lt;/code> directories of each app (For example, in &lt;a href="https://github.com/medic/cht-core/tree/master/webapp/tests" target="_blank" rel="noopener">&lt;code>webapp/tests&lt;/code>&lt;/a> you can find unit test for the webapp). Run them locally with: &lt;code>npm run unit&lt;/code>.&lt;/p>
&lt;h2>Integration Tests&lt;span class="hx-absolute -hx-mt-20" id="integration-tests">&lt;/span>
&lt;a href="#integration-tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>Description&lt;span class="hx-absolute -hx-mt-20" id="description-1">&lt;/span>
&lt;a href="#description-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Tests to exercise how multiple components interact with each other. With a dynamic language like JavaScript these are especially important to verify expectations of interface points. These may mock some parts, but often use the &amp;ldquo;real&amp;rdquo; components since the point is to exercise those components together. As a result, these tests likely involve more setup, potentially involving data scenarios.&lt;/p>
&lt;p>&lt;strong>Write integration tests for:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>Testing interactions between components&lt;/li>
&lt;li>Verifying API endpoints&lt;/li>
&lt;li>Checking database operations&lt;/li>
&lt;/ul>
&lt;h3>Expectations&lt;span class="hx-absolute -hx-mt-20" id="expectations-1">&lt;/span>
&lt;a href="#expectations-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Dramatically fewer than unit tests. The goal is not to verify all branches; it is to gain confidence in interface points.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Execution Speed&lt;/th>
&lt;th>Complexity&lt;/th>
&lt;th>Fragility&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Fast execution, but slower startup when working with a DB&lt;/td>
&lt;td>Mid-to-high. Things can get complex fast when combining parts!&lt;/td>
&lt;td>Mostly stable. Fragility risks tend to come from DB setup.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3>Implementation&lt;span class="hx-absolute -hx-mt-20" id="implementation-1">&lt;/span>
&lt;a href="#implementation-1" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Backend integration testing means testing through the entire stack of the application connected to other applications within the system. In the image below, this involves testing each application (box) and its interaction with other applications within the system.
The tests are isolated from the webapp with necessary shortcuts to make testing more straightforward and faster. No part of the system is mocked.&lt;/p>
&lt;p>&lt;strong>Backend integration tests&lt;/strong> are located in &lt;a href="https://github.com/medic/cht-core/tree/master/tests/integration" target="_blank" rel="noopener">&lt;code>tests/integration&lt;/code>&lt;/a>. Run them locally with &lt;code>npm run integration-all-local&lt;/code> and &lt;code>npm run integration-sentinel-local&lt;/code>.&lt;/p>
&lt;pre class="mermaid hx-mt-6">
flowchart LR
subgraph cht-e2e [Docker: cht-e2e]
api
couchdb-1.local[(couchdb-1)]
couchdb-2.local[(couchdb-2)]
couchdb-3.local[(couchdb-3)]
haproxy
nginx
sentinel
nginx --&amp;gt; api
sentinel --&amp;gt; api
api --&amp;gt; haproxy
haproxy --&amp;gt; couchdb-1.local &amp;amp; couchdb-2.local &amp;amp; couchdb-3.local
end
integration-tests{Integration Tests}
integration-tests &amp;lt;--Pouch/HTTPS--&amp;gt; cht-e2e
&lt;/pre>&lt;p>&lt;strong>Frontend integration tests&lt;/strong> (or web component tests) are designed to validate form behavior (including page layout) without needing to run the whole CHT. The web component isolates the enketo form functionality from the CHT webapp. This only covers forms and not other parts of the webapp. It does not trace behavior though the whole system and the database is never involved. Instead, the whole idea of the web component is to abstract the UI functionality away from the underlying backend complexity.&lt;/p>
&lt;p>Frontend integration tests are located in &lt;a href="https://github.com/medic/cht-core/tree/master/tests/integration" target="_blank" rel="noopener">&lt;code>tests/integration&lt;/code>&lt;/a>. To run them locally you need to build a cht-form Web Component with &lt;code>npm run build-cht-form&lt;/code> and &lt;code>npm run integration-cht-form&lt;/code> to run the web component tests.&lt;/p>
&lt;h2>E2E Tests&lt;span class="hx-absolute -hx-mt-20" id="e2e-tests">&lt;/span>
&lt;a href="#e2e-tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>Description&lt;span class="hx-absolute -hx-mt-20" id="description-2">&lt;/span>
&lt;a href="#description-2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Tests that simulate real user experiences to validate the complete system. You can think of e2e test as the user main workflows when using the system.
E2E tests verify the entire application works as expected from a user&amp;rsquo;s perspective.&lt;/p>
&lt;p>&lt;strong>Write E2E tests for:&lt;/strong>&lt;/p>
&lt;ul>
&lt;li>Testing complete user workflows&lt;/li>
&lt;li>Verifying critical paths&lt;/li>
&lt;li>Checking cross-browser compatibility&lt;/li>
&lt;/ul>
&lt;h3>Expectations&lt;span class="hx-absolute -hx-mt-20" id="expectations-2">&lt;/span>
&lt;a href="#expectations-2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>E2e tests give the most confidence to decide if the feature is working, but must only check the parts of code that the lower-level tests can&amp;rsquo;t cover. The testing levels should be pushed as far down as possible.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Execution Speed&lt;/th>
&lt;th>Complexity&lt;/th>
&lt;th>Fragility&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>Slow. So make sure to check existent tests and maybe just add extra assertions or minor changes instead of directly adding a specific e2e test for your new change. Also, make sure your code is performant.&lt;/td>
&lt;td>Low for the test itself (click tab, enter text into form, click submit, check text on screen. Extremely high for the setup.&lt;/td>
&lt;td>Painful fragility with high risk of race conditions and high maintenance burden. Ensure your code is clean, organized, and utilizes effective selectors.&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h3>Implementation&lt;span class="hx-absolute -hx-mt-20" id="implementation-2">&lt;/span>
&lt;a href="#implementation-2" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Our end-to-end tests are designed to test the entire system as a whole. They interact with the webapp as a user would, using &lt;a href="https://webdriver.io/" target="_blank" rel="noopener">WebdriverIO&lt;/a> to control a headless browser session. They are not isolated from the rest of the system, and they do not use mocking.&lt;/p>
&lt;p>End-to-end tests are located in &lt;a href="https://github.com/medic/cht-core/tree/master/tests/e2e" target="_blank" rel="noopener">&lt;code>tests/e2e&lt;/code>&lt;/a>. Run them locally with the following:&lt;/p>
&lt;ul>
&lt;li>&lt;code>npm run wdio-local&lt;/code> to run the tests for the default config&lt;/li>
&lt;li>&lt;code>npm run wdio-default-mobile-local&lt;/code> to run the mobile tests&lt;/li>
&lt;/ul>
&lt;pre class="mermaid hx-mt-6">
flowchart LR
subgraph cht-e2e [Docker: cht-e2e]
api
couchdb-1.local[(couchdb-1)]
couchdb-2.local[(couchdb-2)]
couchdb-3.local[(couchdb-3)]
haproxy
nginx
sentinel
nginx --&amp;gt; api
sentinel --&amp;gt; api
api --&amp;gt; haproxy
haproxy --&amp;gt; couchdb-1.local &amp;amp; couchdb-2.local &amp;amp; couchdb-3.local
end
subgraph browser
webapp
end
e2e-tests{E2E Tests}
browser &amp;lt;--HTTPS--&amp;gt; cht-e2e
e2e-tests &amp;lt;--wdio--&amp;gt; browser
e2e-tests o--Pouch/HTTPS--o cht-e2e
&lt;/pre>&lt;h2>Contributing Section&lt;span class="hx-absolute -hx-mt-20" id="contributing-section">&lt;/span>
&lt;a href="#contributing-section" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>Ways to Get Involved&lt;span class="hx-absolute -hx-mt-20" id="ways-to-get-involved">&lt;/span>
&lt;a href="#ways-to-get-involved" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>You can contribute to the CHT testing in various ways:&lt;/p>
&lt;ul>
&lt;li>Writing new tests&lt;/li>
&lt;li>Improving existing tests&lt;/li>
&lt;li>Enhancing test documentation&lt;/li>
&lt;li>Reporting test failures&lt;/li>
&lt;li>Suggesting test scenarios&lt;/li>
&lt;/ul>
&lt;h3>Getting Started&lt;span class="hx-absolute -hx-mt-20" id="getting-started">&lt;/span>
&lt;a href="#getting-started" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ol>
&lt;li>Set up your &lt;a href="https://docs.communityhealthtoolkit.org/contribute/code/core/dev-environment/" target="_blank" rel="noopener">development environment&lt;/a>&lt;/li>
&lt;li>Run existing tests to familiarize yourself&lt;/li>
&lt;li>Join the CHT community channels for support&lt;/li>
&lt;li>Start with small, manageable changes&lt;/li>
&lt;/ol>
&lt;h3>How to write automated e2e tests&lt;span class="hx-absolute -hx-mt-20" id="how-to-write-automated-e2e-tests">&lt;/span>
&lt;a href="#how-to-write-automated-e2e-tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Read the &lt;a href="https://docs.communityhealthtoolkit.org/community/contributing/code/core/style-guide-automated-e2e-tests/" >style guide for automated tests&lt;/a> for guidelines on how to create new automated test cases for CHT-Core.&lt;/p>
&lt;h3>Debugging E2E tests&lt;span class="hx-absolute -hx-mt-20" id="debugging-e2e-tests">&lt;/span>
&lt;a href="#debugging-e2e-tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>End to end (e2e) tests can be really difficult to debug - sometimes they fail seemingly at random, and sometimes they only fail on certain environments (eg: ci but not locally). This can make reproducing and reliably fixing the issue challenging, so here are some tips to help!&lt;/p>
&lt;h4>Set the &lt;code>DEBUG&lt;/code> flag&lt;span class="hx-absolute -hx-mt-20" id="set-the-debug-flag">&lt;/span>
&lt;a href="#set-the-debug-flag" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Setting the &lt;code>DEBUG&lt;/code> environment variable (For example: &lt;a href="https://github.com/medic/cht-core/blob/master/tests/wdio.conf.js#L103" target="_blank" rel="noopener">&lt;code>DEBUG=true npm run wdio-local&lt;/code>&lt;/a>) when running the tests locally will do the following:&lt;/p>
&lt;ul>
&lt;li>Run the browser without the &lt;code>headless&lt;/code> flag (details in the &lt;a href="https://github.com/medic/cht-core/blob/master/tests/wdio.conf.js#L35" target="_blank" rel="noopener">&lt;code>wdio.conf&lt;/code>&lt;/a> file), so the browser will be displayed when running the tests&lt;/li>
&lt;li>Increase the test timeout from 2 minutes to 10 minutes&lt;/li>
&lt;li>Prevent Mocha from automatically retrying tests that fail (by default a failing test is retried 5 times, details in the &lt;a href="https://github.com/medic/cht-core/blob/master/tests/wdio.conf.js#L198" target="_blank" rel="noopener">&lt;code>wdio.conf&lt;/code>&lt;/a>file)&lt;/li>
&lt;li>Prevent the &lt;code>cht-e2e&lt;/code> Docker containers from being torn down after the test finishes&lt;/li>
&lt;/ul>
&lt;h4>Run the e2e tests without re-building docker images&lt;span class="hx-absolute -hx-mt-20" id="run-the-e2e-tests-without-re-building-docker-images">&lt;/span>
&lt;a href="#run-the-e2e-tests-without-re-building-docker-images" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>After the tests are executed the first time using the command &lt;code>npm run wdio-local&lt;/code>, the docker images are built in your local environment using the checkout branch name. If it is needed to run the tests repeatedly and there is a certainty that the cht-core code didn&amp;rsquo;t change, you can use the command &lt;code>npm run ci-webdriver-default&lt;/code>. This command will execute the e2e tests as they are run with the &lt;code>wdio-local&lt;/code> command but without re-building the images. This command uses the images that were built previously, which makes the process faster.&lt;/p>
&lt;h4>Read the logs&lt;span class="hx-absolute -hx-mt-20" id="read-the-logs">&lt;/span>
&lt;a href="#read-the-logs" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Read the failure carefully - it often has really good info but sometimes it&amp;rsquo;s just hard to find. Most importantly it tells you exactly the line in the test that failed and you can look that up in the source to see what it was trying to do. The error message itself is also really useful. Also sometimes one error causes the next, so always start with the first test failure before looking at the others.&lt;/p>
&lt;h5>Known failure patterns&lt;span class="hx-absolute -hx-mt-20" id="known-failure-patterns">&lt;/span>
&lt;a href="#known-failure-patterns" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ul>
&lt;li>Can&amp;rsquo;t click on an element because another element would get the click. This usually means a modal dialog was being shown. 90% of the time this is the update notification modal which means some settings change has been detected after the test started execution.&lt;/li>
&lt;li>Stale element. This means the DOM element has been removed after it was found on the page but before trying to do something with it. Generally try to find the element just before it needs it to reduce the chance of this happening&lt;/li>
&lt;/ul>
&lt;h4>Other logs and screenshots&lt;span class="hx-absolute -hx-mt-20" id="other-logs-and-screenshots">&lt;/span>
&lt;a href="#other-logs-and-screenshots" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>GitHub actions will artifact all files in tests/logs. This is the directory any logs, results, images, etc&amp;hellip; should save to if you want to review them if a build fails.&lt;/p>
&lt;h5>View the CI report&lt;span class="hx-absolute -hx-mt-20" id="view-the-ci-report">&lt;/span>
&lt;a href="#view-the-ci-report" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;p>There are logs and screenshots stored in the allure reports when a job failed on the CI. To access to those logs follow these steps:&lt;/p>
&lt;ul>
&lt;li>Download the CI run artifact zip file located in the failed build&amp;rsquo;s &lt;code>Archive Results&lt;/code> section.
&lt;figure class=" center col-12 col-lg-12">&lt;a href="archiveResultsSection.png">&lt;img src="https://docs.communityhealthtoolkit.org/community/contributing/code/core/automated-tests/archiveResultsSection.png">&lt;/a>
&lt;/figure>
&lt;/li>
&lt;li>Extract the &lt;code>.zip&lt;/code> file.&lt;/li>
&lt;li>From your cht-core directory, run &lt;code>npx allure open &amp;lt;path&amp;gt;/allure-report/&lt;/code>. Being &lt;code>&amp;lt;path&amp;gt;&lt;/code> the location where the zip file was extracted.&lt;/li>
&lt;/ul>
&lt;h4>Running just the failing test&lt;span class="hx-absolute -hx-mt-20" id="running-just-the-failing-test">&lt;/span>
&lt;a href="#running-just-the-failing-test" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Running e2e tests can be quite slow so to save time modify the &lt;code>specs&lt;/code> property of &lt;a href="https://github.com/medic/cht-core/blob/master/tests/e2e/default/wdio.conf.js#L7" target="_blank" rel="noopener">&lt;code>/tests/e2e/**/wdio.conf.js&lt;/code>&lt;/a> so it only finds your test. You can also use &lt;code>describe.skip&lt;/code> and &lt;code>it.skip&lt;/code> to skip specific tests.&lt;/p>
&lt;h5>IntelliJ Based&lt;span class="hx-absolute -hx-mt-20" id="intellij-based">&lt;/span>
&lt;a href="#intellij-based" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h5>&lt;ol>
&lt;li>In a terminal, run &lt;code>npm run build-dev-watch&lt;/code>&lt;/li>
&lt;li>In Intellij, open the &lt;a href="https://github.com/medic/cht-core/blob/master/package.json" target="_blank" rel="noopener">package.json&lt;/a> file&lt;/li>
&lt;li>Scroll to the scripts section and click the â–¶ button next to &lt;code>wdio-local&lt;/code>&lt;/li>
&lt;li>Select &lt;code>Debug 'wdio-local'&lt;/code>&lt;/li>
&lt;/ol>
&lt;h4>Watching the test run&lt;span class="hx-absolute -hx-mt-20" id="watching-the-test-run">&lt;/span>
&lt;a href="#watching-the-test-run" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Running the tests locally (For example, with &lt;code>npm run wdio-local&lt;/code>) will allow you to watch it run but if you interact with the page the test will fail in unexpected ways. Furthermore the browser will close after a short timeout so you won&amp;rsquo;t be able to inspect the console or DOM. To do this, force quit the process running the test before it tears down and you will be able to navigate around the app, use Chrome dev tools, and inspect the docs in the database to (hopefully) work out what&amp;rsquo;s going wrong.&lt;/p>
&lt;h4>Running the upgrade e2e test locally&lt;span class="hx-absolute -hx-mt-20" id="running-the-upgrade-e2e-test-locally">&lt;/span>
&lt;a href="#running-the-upgrade-e2e-test-locally" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>To run the upgrade e2e tests in your local environment, follow these steps:&lt;/p>
&lt;ul>
&lt;li>Make sure your branch has been published, and it&amp;rsquo;s available in the market:
&lt;ul>
&lt;li>A way to do this is by pushing the branch, let the GitHubActions to run, if all the other e2e are okay, then it will publish the branch.&lt;/li>
&lt;li>Check that your branch name is available &lt;a href="https://staging.dev.medicmobile.org/_couch/builds_4/_design/builds/_view/releases" target="_blank" rel="noopener">here&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Make sure to stop all existing containers&lt;/li>
&lt;li>Set these environment variables:
&lt;ul>
&lt;li>&lt;code>export MARKET_URL_READ=https://staging.dev.medicmobile.org&lt;/code>.&lt;/li>
&lt;li>&lt;code>export STAGING_SERVER=_couch/builds_4&lt;/code>.&lt;/li>
&lt;li>&lt;code>export BRANCH=&amp;lt;your branch name&amp;gt;&lt;/code>.&lt;/li>
&lt;li>&lt;code>export BASE_VERSION=&amp;lt;CHT base version&amp;gt;&lt;/code>(it can be used &lt;code>latest&lt;/code> as the value).&lt;/li>
&lt;li>&lt;code>export TAG=&amp;lt;CHT version&amp;gt;&lt;/code>(Optional, For example: &lt;code>4.8.1&lt;/code>).&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Run the upgrade e2e tests: &lt;code>npm run upgrade-wdio&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>If you experience errors such as:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">Error in hook: StatusCodeError: &lt;span class="m">404&lt;/span> - &lt;span class="s2">&amp;#34;{\&amp;#34;error\&amp;#34;:\&amp;#34;not_found\&amp;#34;,\&amp;#34;reason\&amp;#34;:\&amp;#34;Document is missing attachment\&amp;#34;}\n&amp;#34;&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Try the following:&lt;/p>
&lt;ul>
&lt;li>It&amp;rsquo;s probably because it can&amp;rsquo;t find the latest released version of CHT, double check that &lt;code>MARKET_URL_READ&lt;/code> and &lt;code>STAGING_SERVER&lt;/code> environment variables are set.&lt;/li>
&lt;/ul>
&lt;p>If you experience errors such as:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">If you are seeing this locally, it can mean that your internet is too slow to download all images in the allotted time.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">Either run the &lt;span class="nb">test&lt;/span> multiple &lt;span class="nb">times&lt;/span> &lt;span class="k">until&lt;/span> you load all images, download images manually or increase this timeout.&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Try the following:&lt;/p>
&lt;ul>
&lt;li>Manually downloaded the images. To download images manually, you can use either &lt;code>docker compose&lt;/code> or &lt;code>docker&lt;/code>:
&lt;ul>
&lt;li>With &lt;code>docker&lt;/code>, you&amp;rsquo;d do a docker pull &lt;image tag> for every image you want to download.&lt;/li>
&lt;li>With &lt;code>docker compose&lt;/code>, you&amp;rsquo;d save all docker-compose files in a folder, do a &lt;code>docker compose pull&lt;/code>, and point to your files as a source. Read more on &lt;a href="https://docs.docker.com/engine/reference/commandline/compose_pull/" target="_blank" rel="noopener">docker compose pull&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>If you experience errors such as:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">A user session timing out &lt;span class="k">while&lt;/span> running the test.&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>This could be because there are some issues with data or there could be a large number of images and volumes that caused docker to crash.
To resolve this, it&amp;rsquo;s recommended to clean all docker data for a fresh start. Note that these commands will delete everything.
The e2e tests might take a little longer to run because all the images need to be downloaded again.&lt;/p>
&lt;p>Try running the following commands:&lt;/p>
&lt;ul>
&lt;li>&lt;code>docker system prune&lt;/code>&lt;/li>
&lt;li>&lt;code>docker image prune -a&lt;/code>&lt;/li>
&lt;li>&lt;code>docker volume prune -a&lt;/code>&lt;/li>
&lt;li>&lt;code>docker network prune&lt;/code>&lt;/li>
&lt;/ul>
&lt;p>Repeat the above steps until all data has been deleted.&lt;/p>
&lt;h3>Test Architecture&lt;span class="hx-absolute -hx-mt-20" id="test-architecture">&lt;/span>
&lt;a href="#test-architecture" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>CHT Core GitHub actions spin up an ubuntu-22.04 machine. They install software and then launch couchdb and horticulturalist in a docker container. This is needed to run the applications in the specific supported &lt;code>node&lt;/code> versions, while allowing the test code to run in versions of &lt;code>node&lt;/code> it supports. This creates a paradigm to keep in mind when writing tests. Tests run on the ubuntu machine.
Any test code that starts a server or runs an executable is running outside of the horti container. The ports are exposed for all the services and horti has access to the cht-core root via a volume. Horti can also talk to the host by getting the gateway of the docker network.&lt;/p>
&lt;h3>Support and Community Resources&lt;span class="hx-absolute -hx-mt-20" id="support-and-community-resources">&lt;/span>
&lt;a href="#support-and-community-resources" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>The CHT Community is here to help you succeed with testing:&lt;/p>
&lt;ul>
&lt;li>Questions? Ask in the &lt;a href="https://forum.communityhealthtoolkit.org/" target="_blank" rel="noopener">Community Forum&lt;/a>&lt;/li>
&lt;li>Need help debugging? Check the &lt;a href="https://docs.communityhealthtoolkit.org/community/contributing/code/core/automated-tests/#debugging-e2e-tests" >Troubleshooting Guide&lt;/a>&lt;/li>
&lt;li>Found a bug? &lt;a href="https://github.com/medic/cht-core/issues" target="_blank" rel="noopener">Open an issue&lt;/a>&lt;/li>
&lt;li>Want to contribute to testing? See the &lt;a href="https://docs.communityhealthtoolkit.org/community/contributing/code/core/automated-tests/#ways-to-get-involved" >Contribution Guide&lt;/a>&lt;/li>
&lt;/ul>
&lt;p>Remember, every contributor was once new to the project. Don&amp;rsquo;t hesitate to ask for help!&lt;/p></description></item><item><title>Style guide for automated tests</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/style-guide-automated-e2e-tests/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/style-guide-automated-e2e-tests/</guid><description>
&lt;p>There are three files that are the base of every new automated test case, the most important one is the &lt;code>spec&lt;/code> file, which contains the actual test that will be executed.&lt;/p>
&lt;p>Automated tests cover different &lt;a href="https://github.com/medic/cht-core/tree/master/config" target="_blank" rel="noopener">CHT Configs&lt;/a>, consider the following setups when writing a new test:&lt;/p>
&lt;ul>
&lt;li>&lt;strong>default&lt;/strong>
&lt;ul>
&lt;li>Config file: &lt;a href="https://github.com/medic/cht-core/blob/master/tests/e2e/default/wdio.conf.js" target="_blank" rel="noopener">&lt;code>../tests/e2e/default/wdio.conf.js&lt;/code>&lt;/a>&lt;/li>
&lt;li>Name convention for the &lt;code>spec&lt;/code> file: &lt;code>../tests/e2e/default/*/&amp;lt;name&amp;gt;.wdio-spec.js&lt;/code>&lt;/li>
&lt;li>Command to execute the tests that belong to this config: &lt;code>npm run wdio-local&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;p>&lt;strong>Important:&lt;/strong> Make sure the &lt;code>spec&lt;/code> file follows the name convention, otherwise the file won&amp;rsquo;t be executed.&lt;/p>
&lt;h2>Base files to use&lt;span class="hx-absolute -hx-mt-20" id="base-files-to-use">&lt;/span>
&lt;a href="#base-files-to-use" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>
&lt;p>Page-object file. (&lt;code>../tests/page-objects/../enketo/&amp;lt;name&amp;gt;.wdio.page.js&lt;/code>)
We are leveraging the &lt;a href="https://www.thoughtworks.com/insights/blog/using-page-objects-overcome-protractors-shortcomings" target="_blank" rel="noopener">page object model&lt;/a> for structure. When identifying elements they should be added to a page object and not within a test file. Add functions that perform actions to the page within the page object. Keep expects outside of page objects. The tests should be self-documenting.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Data file.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>Create test data using the &lt;a href="https://github.com/medic/cht-core/blob/master/tests/factories/cht/contacts/place.js" target="_blank" rel="noopener">&lt;code>place factory&lt;/code>&lt;/a>, the &lt;a href="https://github.com/medic/cht-core/blob/master/tests/factories/cht/users/users.js" target="_blank" rel="noopener">&lt;code>user factory&lt;/code>&lt;/a> or the &lt;a href="https://github.com/medic/cht-core/blob/master/tests/factories/cht/contacts/person.js" target="_blank" rel="noopener">&lt;code>person factory&lt;/code>&lt;/a> files.&lt;/p>
&lt;p>Using the &amp;ldquo;factories&amp;rdquo; will allow you to create hierarchies, contacts and patients that are associated with specific places and with their specific attributes and information. It can create offline or online users that can be used to login with different roles. &lt;strong>Everything can be customised depending on the test requirements&lt;/strong>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>e2e testing file. Use the correct name convention when working with the following configs:&lt;/p>
&lt;ul>
&lt;li>default: (&lt;code>../tests/e2e/default/*/&amp;lt;name&amp;gt;.wdio-spec.js&lt;/code>)&lt;/li>
&lt;/ul>
&lt;p>This file should contain &lt;strong>only&lt;/strong> the scenario setup and assertions of the test that is going to be executed. All the DOM queries, logging, contact creation and data assignments should be delegated to the Page Object file and the Data file. This will increase test readability and code reusability. For a better understanding follow these files as examples:&lt;/p>
&lt;ul>
&lt;li>default config: &lt;a href="https://github.com/medic/cht-core/blob/master/tests/e2e/default/enketo/pregnancy-visit.wdio-spec.js" target="_blank" rel="noopener">&lt;code>../tests/e2e/default/enketo/pregnancy-visit.wdio-spec.js&lt;/code>&lt;/a>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h2>Tips to write test cases&lt;span class="hx-absolute -hx-mt-20" id="tips-to-write-test-cases">&lt;/span>
&lt;a href="#tips-to-write-test-cases" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;h3>File Structure (spec files)&lt;span class="hx-absolute -hx-mt-20" id="file-structure-spec-files">&lt;/span>
&lt;a href="#file-structure-spec-files" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>Test files should represent a feature within the application. Use &lt;code>describe&lt;/code> to identify the feature and to group helper functions and test cases. Use &lt;code>it&lt;/code> to detail individual test cases covering the feature&amp;rsquo;s functionality.
It is important that the database is clean and settings are restored once the tests are complete; we re-try the tests if they fail, and we need to make sure that for every new try, the environment is as it was the first time. Additionally, each &lt;code>it&lt;/code> block should be independent of the others, ensuring that any single test case can be rerun on its own and still work as expected.&lt;/p>
&lt;p>Observe how the following example defines a &lt;code>describe&lt;/code> using the feature name &lt;code>Immunization Visit&lt;/code>. It contains constant definitions, helper functions, the &lt;code>before&lt;/code> and &lt;code>after&lt;/code> hooks to prepare the environment, and two test cases that detail the expected results &lt;code>should add a new child under 2 years old&lt;/code> and &lt;code>should submit an immunization visit&lt;/code>.&lt;/p>
&lt;p>Ex:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-js" data-lang="js">&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">describe&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Immunization Visit&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">firstConstant&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;SampleName&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">secondConstant&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="s1">&amp;#39;SampleValue&amp;#39;&lt;/span>&lt;span class="p">;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">firstHelperFunction&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="kr">const&lt;/span> &lt;span class="nx">secondHelperFunction&lt;/span> &lt;span class="o">=&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">}&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">before&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kr">async&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">beforeEach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kr">async&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">after&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kr">async&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">afterEach&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="kr">async&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">it&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;should add a new child under 2 years old&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nx">it&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;should submit an immunization visit&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="p">()&lt;/span> &lt;span class="p">=&amp;gt;&lt;/span> &lt;span class="p">{&lt;/span> &lt;span class="p">....&lt;/span> &lt;span class="p">});&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">...&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="p">});&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h3>Name convention and file location&lt;span class="hx-absolute -hx-mt-20" id="name-convention-and-file-location">&lt;/span>
&lt;a href="#name-convention-and-file-location" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;ul>
&lt;li>Since every test is created by &lt;em>&amp;ldquo;selectors&amp;rdquo;&lt;/em>, it makes sense to locate them into a folder that represents the page being tested and not the feature. Try to locate every test file in the correct folder.&lt;/li>
&lt;li>Every file name should use &lt;code>dash-case&lt;/code> (&lt;code>-&lt;/code>). Do not use &lt;code>snake-case&lt;/code> (&lt;code>_&lt;/code>) nor &lt;code>camelCase&lt;/code>. Consider the following examples:
&lt;ul>
&lt;li>Correct:
&lt;ul>
&lt;li>&lt;code>pregnancy-visit.wdio-spec.js&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Incorrect:
&lt;ul>
&lt;li>&lt;code>pregnancy_visit.wdio-spec.js&lt;/code>&lt;/li>
&lt;li>&lt;code>pregnancyVisit.wdio-spec.js&lt;/code>&lt;/li>
&lt;li>&lt;code>PregnancyVisit.wdio-spec.js&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Whenever possible avoid repeating the folder name in the file name. Consider the following examples where the file is located in the path &lt;code>e2e/default/enketo&lt;/code>:
&lt;ul>
&lt;li>Correct:
&lt;ul>
&lt;li>&lt;code>pregnancy-visit.wdio-spec.js&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Incorrect:
&lt;ul>
&lt;li>&lt;code>pregnancy-visit-enketo.wdio-spec.js&lt;/code>&lt;/li>
&lt;li>&lt;code>pregnancy-visit-default.wdio-spec.js&lt;/code>&lt;/li>
&lt;li>&lt;code>pregnancy-visit-enketo-default.wdio-spec.js&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;h3>Adding identifiers&lt;span class="hx-absolute -hx-mt-20" id="adding-identifiers">&lt;/span>
&lt;a href="#adding-identifiers" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>In some cases, adding a unique identifier to an element may be necessary. This could be a piece of data related to the element, or a unique name (which can be done by adding a &lt;code>test-&lt;/code> attribute to the app code).&lt;/p>
&lt;p>Ex: &lt;code>attr.test-id=&amp;quot;{{ msg.key }}&amp;quot; &lt;/code> Will add a &lt;code>test-id&lt;/code> attribute with the data from the app.&lt;/p>
&lt;p>Then it can be consumed in the test by getting an element by css. EX: &lt;code>element(by.css(`#message-list li[test-id=&amp;quot;${identifier}&amp;quot;]`)),&lt;/code>&lt;/p>
&lt;p>Adding a test identifier is a good option for cases where a CSS selector would otherwise be fragile such as selecting based on an assumed element structure or selecting on CSS classes intended for visual design that may change.&lt;/p>
&lt;h3>Test tags&lt;span class="hx-absolute -hx-mt-20" id="test-tags">&lt;/span>
&lt;a href="#test-tags" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h3>&lt;p>You can tag mocha tests and update suites to only include or exclude certain tags (&lt;a href="https://github.com/mochajs/mocha/wiki/Tagging" target="_blank" rel="noopener">Mocha Wiki&lt;/a>).&lt;/p>
&lt;p>Existent tags:&lt;/p>
&lt;h4>@docker&lt;span class="hx-absolute -hx-mt-20" id="docker">&lt;/span>
&lt;a href="#docker" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Tests that should run exclusively when running the suite over docker infrastructure. These tests will fail if run over k3d.&lt;/p>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200">
&lt;p class="hx-flex hx-items-center hx-font-medium">&lt;svg height=16px class="hx-inline-block hx-align-middle hx-mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>&lt;/svg>Note&lt;/p>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;ul>
&lt;li>We decided to separate every functionality in files/folders because we want to make sure that we can reuse as much code as possible. If something new is implemented and might be used for another test, then isolate the code in a separate file, so it can be reused in future tests.&lt;/li>
&lt;li>If the new test is not associated to a specific configuration, locate the test inside the correct folder of the default config &lt;a href="https://github.com/medic/cht-core/tree/master/tests/e2e/default" target="_blank" rel="noopener">&lt;code>e2e/default/*&lt;/code>&lt;/a>.&lt;/li>
&lt;/ul>&lt;/div>
&lt;/div>
&lt;/div></description></item><item><title>Apdex Automated Tests</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/apdex-automation-tests/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/apdex-automation-tests/</guid><description>
&lt;p>This documentation will guide you on how to setup and configure automation to run performance tests for your CHT Applications.&lt;/p>
&lt;h2>Prerequisites&lt;span class="hx-absolute -hx-mt-20" id="prerequisites">&lt;/span>
&lt;a href="#prerequisites" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Before continuing with the steps below, ensure:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>You have a &lt;a href="https://docs.communityhealthtoolkit.org/hosting/4.x/app-developer/" >cht instance deployed&lt;/a> and running either locally or globally.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>You have some pre-existing users and data already loaded on the app. Use the &lt;a href="https://github.com/medic/test-data-generator" target="_blank" rel="noopener">test-data-generator&lt;/a> tool to achieve this.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If you already have the CHT Android app installed, set the &lt;code>appPath&lt;/code> value (in the capabilities section of the settings file) to an empty string.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If you do not have the CHT Android app installed on your mobile device, download the preferred &lt;a href="https://github.com/medic/cht-android/releases" target="_blank" rel="noopener">apk version&lt;/a> and then set the &lt;code>appPath&lt;/code> value to the absolute path of the apk file.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Finally, ensure you have done the following installations on your machine:&lt;/p>
&lt;/li>
&lt;/ol>
&lt;ul>
&lt;li>Install &lt;a href="https://nodejs.org/en/download" target="_blank" rel="noopener">NodeJS&lt;/a> and &lt;a href="https://www.oracle.com/java/technologies/downloads/" target="_blank" rel="noopener">Java JDK&lt;/a> then ensure JAVA_HOME path is correctly set up.
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">JAVA_HOME&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="k">$(&lt;/span>/usr/libexec/java_home&lt;span class="k">)&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;/li>
&lt;li>Install and Set-up &lt;a href="https://developer.android.com/studio/install" target="_blank" rel="noopener">Android studio&lt;/a> and the &lt;code>adb tool&lt;/code> to enable you run adb commands.
&lt;ul>
&lt;li>Add the Android SDK directory to your systemâ€™s ANDROID_HOME environment variable.&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> &lt;span class="nv">ANDROID_HOME&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="s2">&amp;#34;/Users/yourpath/Library/Android/sdk/&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> &lt;span class="nv">PATH&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$ANDROID_HOME&lt;/span>/platform-tools:&lt;span class="nv">$PATH&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nb">export&lt;/span> &lt;span class="nv">PATH&lt;/span>&lt;span class="o">=&lt;/span>&lt;span class="nv">$ANDROID_HOME&lt;/span>/tools:&lt;span class="nv">$PATH&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>To set up an Android Virtual Device (AVD), open Android Studio, click on &lt;em>More Actions&lt;/em> &amp;gt; &lt;em>Virtual Device Manager&lt;/em>, and then proceed with the virtual device creation by selecting the hardware and system image.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Install appium and appium doctor.&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">npm install -g appium@next
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">npm install -g appium-doctor&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>Install appium driver - &lt;code>appium driver install uiautomator2&lt;/code>&lt;/li>
&lt;/ul>
&lt;h2>Steps (running the tests)&lt;span class="hx-absolute -hx-mt-20" id="steps-running-the-tests">&lt;/span>
&lt;a href="#steps-running-the-tests" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ol>
&lt;li>
&lt;p>Enable the developer mode in your phone and enable the USB Debugger mode.&lt;/p>
&lt;ul>
&lt;li>Ensure your device does not have a lock screen PIN/Passcode.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Connect your phone to the computer using the appropriate device cable or you can follow &lt;a href="https://developer.android.com/studio/run/device#wireless" target="_blank" rel="noopener">these steps&lt;/a> to connect your device using Wi-Fi.&lt;/p>
&lt;ul>
&lt;li>Run the &lt;code>adb devices&lt;/code> command to confirm that your device is listed among the attached devices.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Create a settings file or reuse one of the provided &lt;a href="https://github.com/medic/cht-core/tree/master/tests/performance/apdex-score/sample-settings-files" target="_blank" rel="noopener">sample settings&lt;/a> files.&lt;/p>
&lt;details> &lt;summary>Expand to see settings file structure &lt;/summary>
&lt;pre>&lt;code>```js
{
&amp;quot;iterations&amp;quot;: 1,
&amp;quot;instanceURL&amp;quot;: &amp;quot;&amp;lt;instance url&amp;gt;&amp;quot;,
&amp;quot;hasPrivacyPolicy&amp;quot;: false,
&amp;quot;capabilities&amp;quot;: [
{
&amp;quot;platformVersion&amp;quot;: &amp;quot;&amp;lt;android version&amp;gt;&amp;quot;,
&amp;quot;deviceName&amp;quot;: &amp;quot;&amp;lt;phone model&amp;gt;&amp;quot;,
&amp;quot;appPath&amp;quot;: &amp;quot;&amp;lt;path to cht android apk&amp;gt;&amp;quot;,
&amp;quot;noReset&amp;quot;: false
}
],
&amp;quot;skip&amp;quot;: {
&amp;quot;login&amp;quot;: false,
&amp;quot;loadContactList&amp;quot;: false,
&amp;quot;loadChwArea&amp;quot;: false,
&amp;quot;loadHousehold&amp;quot;: false,
&amp;quot;loadPatient&amp;quot;: false,
&amp;quot;loadMessageList&amp;quot;: false,
&amp;quot;loadTaskList&amp;quot;: false,
&amp;quot;loadAnalytics&amp;quot;: false,
&amp;quot;loadReportList&amp;quot;: false,
&amp;quot;searchContact&amp;quot;: false,
&amp;quot;searchReport&amp;quot;: false,
&amp;quot;submitTask&amp;quot;: true,
&amp;quot;createPatient&amp;quot;: true,
&amp;quot;submitPatientReport&amp;quot;: true
},
&amp;quot;users&amp;quot;: [
{
&amp;quot;type&amp;quot;: &amp;quot;offline&amp;quot;,
&amp;quot;role&amp;quot;: &amp;quot;chw&amp;quot;,
&amp;quot;username&amp;quot;: &amp;quot;&amp;lt;username&amp;gt;&amp;quot;,
&amp;quot;password&amp;quot;: &amp;quot;&amp;lt;password&amp;gt;&amp;quot;
}
],
&amp;quot;pages&amp;quot;: {
&amp;quot;contactList&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Reports\&amp;quot;]&amp;quot; },
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;People\&amp;quot;]&amp;quot;,
&amp;quot;asserts&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;West Miltonside\&amp;quot;)]&amp;quot; } ]
}
],
&amp;quot;search&amp;quot;: {
&amp;quot;value&amp;quot;: &amp;quot;Rafael Windler&amp;quot;,
&amp;quot;asserts&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Rafael Windler\&amp;quot;]&amp;quot; },
{
&amp;quot;scrollDown&amp;quot;: 5,
&amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;No more people\&amp;quot;)]&amp;quot;
}
],
&amp;quot;postTestPath&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Reports\&amp;quot;]&amp;quot; }
]
}
},
&amp;quot;chwArea&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;West Miltonside\&amp;quot;)]&amp;quot;,
&amp;quot;asserts&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;External ID\&amp;quot;)]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Rafael Windler\&amp;quot;)]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Households\&amp;quot;)]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Abilene\&amp;quot;)]&amp;quot; }
]
}
],
&amp;quot;postTestPath&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Back\&amp;quot;]&amp;quot; } ]
},
&amp;quot;household&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;West Miltonside\&amp;quot;)]&amp;quot; },
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Abilene\&amp;quot;)]&amp;quot;,
&amp;quot;asserts&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Phone\&amp;quot;)]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Bill Pouros\&amp;quot;)]&amp;quot; },
{
&amp;quot;scrollDown&amp;quot;: 2,
&amp;quot;selector&amp;quot;: &amp;quot;//*[text()[contains(.,\&amp;quot;Danger sign follow up\&amp;quot;)]&amp;quot;
},
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[text()[contains(.,\&amp;quot;Due today\&amp;quot;)]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[text()[contains(.,\&amp;quot;Pregnancy danger sign\&amp;quot;)]&amp;quot; }
]
}
]
},
&amp;quot;patient&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Irene Shields\&amp;quot;)]&amp;quot;,
&amp;quot;asserts&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;37 years\&amp;quot;)]&amp;quot; },
{
&amp;quot;scrollDown&amp;quot;: 1,
&amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Danger sign follow up\&amp;quot;)]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Pregnancy danger sign\&amp;quot;)]&amp;quot; }
]
}
],
&amp;quot;postTestPath&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Back\&amp;quot;]&amp;quot; } ]
},
&amp;quot;messageList&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Messages\&amp;quot;]&amp;quot;,
&amp;quot;asserts&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;No messages found\&amp;quot;)]&amp;quot; } ]
}
]
},
&amp;quot;reportList&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Reports\&amp;quot;]&amp;quot;,
&amp;quot;asserts&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Pregnancy danger sign\&amp;quot;)]&amp;quot; } ]
}
],
&amp;quot;search&amp;quot;: {
&amp;quot;value&amp;quot;: &amp;quot;Alexandra Lemke&amp;quot;,
&amp;quot;asserts&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;No reports found\&amp;quot;)]&amp;quot;
}
],
&amp;quot;postTestPath&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Tasks\&amp;quot;]&amp;quot; }
]
}
},
&amp;quot;taskList&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Tasks\&amp;quot;]&amp;quot;,
&amp;quot;asserts&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Danger sign follow up\&amp;quot;)]&amp;quot; } ]
}
]
},
&amp;quot;targets&amp;quot;: {
&amp;quot;navigation&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Targets\&amp;quot;]&amp;quot;,
&amp;quot;asserts&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;New pregnancies\&amp;quot;)]&amp;quot; } ]
}
]
}
},
&amp;quot;forms&amp;quot;: {
&amp;quot;patientReport&amp;quot;: {
&amp;quot;navigation&amp;quot;: [{
&amp;quot;scrollDown&amp;quot;: 3,
&amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Pregnancy\&amp;quot;]&amp;quot;
}],
&amp;quot;pages&amp;quot;: [
{
&amp;quot;asserts&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Select patient\&amp;quot;)]&amp;quot; } // Wait for form to load
],
&amp;quot;fields&amp;quot;: [
{
&amp;quot;selector&amp;quot;: &amp;quot;&amp;lt;Mandatory. XPath selector of radio buttons, text boxes (to open keyboard), etc.&amp;gt;&amp;quot;,
// Optional. Use this when you need to type in the phone's keyboard, find the keycodes here: https://developer.android.com/reference/android/view/KeyEvent
&amp;quot;keycodes&amp;quot;: &amp;quot;&amp;lt;Array of numbers (keycodes)&amp;gt;&amp;quot;,
// Optional. Use this when you want an equivalent of element.setValue(myValue)
&amp;quot;value&amp;quot;: &amp;quot;&amp;lt;String. Field value&amp;gt;&amp;quot;,
// Optional. Use this when you want to select an option from a dropdown. The dropdown will open with the &amp;quot;selector&amp;quot; property
&amp;quot;dropdownOption&amp;quot;: &amp;quot;&amp;lt;String. XPath selector to a dropdown option and clicks on it.&amp;gt;&amp;quot;,
// Optional. Number of scrolls to reach the field
&amp;quot;scrollDown&amp;quot;: 1,
&amp;quot;scrollUp&amp;quot;: 1
}
],
// Optional. Number of scrolls to reach the page's buttons
&amp;quot;scrollDown&amp;quot;: 2,
&amp;quot;scrollUp&amp;quot;: 1
},
{ // Add this to assert the form summary page.
&amp;quot;asserts&amp;quot;: [
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Pregnancy in danger\&amp;quot;]&amp;quot; },
{ &amp;quot;selector&amp;quot;: &amp;quot;//*[contains(@text, \&amp;quot;Refer patient to clinic\&amp;quot;)]&amp;quot; }
],
// Optional. Number of scrolls to reach the page's buttons
&amp;quot;scrollDown&amp;quot;: 2,
&amp;quot;scrollUp&amp;quot;: 3
}
],
&amp;quot;postSubmitAsserts&amp;quot;: [ // Add to assert result after form is submitted.
{ &amp;quot;select&amp;quot;: &amp;quot;//android.widget.TextView[contains(@text, \&amp;quot;Submitted by Paula\&amp;quot;)]&amp;quot; }
],
&amp;quot;postTestPath&amp;quot;: [ { &amp;quot;selector&amp;quot;: &amp;quot;//*[@text=\&amp;quot;Back\&amp;quot;]&amp;quot; } ]
}
}
}
```
&lt;/code>&lt;/pre>
&lt;/li>
&lt;/ol>
&lt;/details>
&lt;ol start="4">
&lt;li>Set the environment variable &lt;code>APDEX_TEST_SETTINGS&lt;/code> with the path of your settings file (apdex-settings.json).
For example, you can use the following command but make sure to replace the path with your actual settings file location:
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-shell" data-lang="shell">&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">APDEX_TEST_SETTINGS&lt;/span>&lt;span class="o">=&lt;/span>/Users/pepe/Documents/apdex-settings.json&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>Ensure the &lt;code>apdex-settings.json&lt;/code> file has been updated with the correct instance url, login credentials and assertion texts (which correspond to the data in your cht instance) for page navigation, forms and other app interactions.&lt;/li>
&lt;li>Under the skip section of the settings file, set &lt;code>true&lt;/code> for the tests you want to skip and &lt;code>false&lt;/code> for those you want to execute.&lt;/li>
&lt;li>Update the fields for &lt;code>platformVersion&lt;/code> and &lt;code>deviceName&lt;/code> to match the value for your device.
&lt;ul>
&lt;li>Find the android version (&lt;code>platformVersion&lt;/code>) by running &lt;code>adb shell getprop | grep ro.build.version.release&lt;/code>.&lt;/li>
&lt;li>Find the device name (&lt;code>deviceName&lt;/code>) by running &lt;code>adb shell getprop | grep ro.product.model&lt;/code>.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Ensure all dependencies have been properly installed - run &lt;code>npm ci&lt;/code> from the root directory.&lt;/li>
&lt;li>Run &lt;code>npm run apdex-test&lt;/code> from the root directory to execute the selected tests.&lt;/li>
&lt;/ol>
&lt;h2>Settings file&lt;span class="hx-absolute -hx-mt-20" id="settings-file">&lt;/span>
&lt;a href="#settings-file" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>The settings file enables the navigation and interaction between pages, forms, and components by providing the required selectors, commands and assertion texts in the appropriate fields to be used during test execution.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Property&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Mandatory&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>iterations&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to run the test cases&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>instanceURL&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Instance url&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>hasPrivacyPolicy&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Whether it has privacy policies to accept&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>capabilities&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Configures Appium to use your device for testing&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>capabilities.platformVersion&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Android version. E.g. &amp;ldquo;13&amp;rdquo;. Find the android version by running &lt;code>adb shell getprop grep ro.build.version.release&lt;/code>&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>capabilities.deviceName&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Device name. E.g. &amp;ldquo;Neon Ray Ultra S&amp;rdquo;. Find the device name by running &lt;code>adb shell getprop grep ro.product.model&lt;/code>&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>capabilities.appPath&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Path to CHT Android APK. E.g. &amp;ldquo;/Users/john/Downloads/cht-android-v1.4.0-unbranded-armeabi-v7a-release.apk&amp;rdquo;&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>capabilities.noReset&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. When set false, it deletes the app cache and storage data. If set to true, the app will start again in the last page it was before, review your configuration to take that start point.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.login&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip login, and it&amp;rsquo;s expected that the user has already login previous running the automation tests.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadContactList&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading the contact list.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadChwArea&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading the CHT Area.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadHousehold&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading a household.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadPatient&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading a patient.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.searchContact&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for searching patient.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadTaskList&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading the task list.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.submitTask&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for submitting a task.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadTargets&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading the targets page.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.loadReportList&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for loading the report list.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.searchReport&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for searching a report.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.createPatient&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for creating a patient.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>skip.submitPatientReport&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Default false. Skip test for submiting a report for a patient.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>users&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>User to login and use for testing&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>users.type&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Use: &amp;ldquo;offline&amp;rdquo; or &amp;ldquo;online&amp;rdquo;&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>users.role&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Use: &amp;ldquo;chw&amp;rdquo;&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>users.username&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Username&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>users.password&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Password&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Overrides selectors of system elements&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements.fab&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements.fabListTitle&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements.formSubmit&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Form&amp;rsquo;s submit button label&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements.formNext&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Form&amp;rsquo;s next button label&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements.relaunchAppAssert&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>commonElements.searchIcon&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Object containing the definition of the pages that the automation tests use. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.contactList&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Contact List page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.chwArea&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Contact CHW Area page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.household&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Contact Household page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.patient&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Contact Patient page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.messageList&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Message List page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.reportList&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Report List page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.taskList&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Task List page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.targets&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for Targets page. See Pages section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>forms&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for app forms or contact forms that the automation tests use. See Forms section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>forms.patientReport&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for an app form that is submitted on the Patient page. See Forms section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>forms.patientContact&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Definition for a contact form that is used to create patients. Submitted from the Household page. See Forms section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4>Pages&lt;span class="hx-absolute -hx-mt-20" id="pages">&lt;/span>
&lt;a href="#pages" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Object containing the definition of the pages to load and assert during these automation tests.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Property&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Mandatory&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>navigation&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Click path to navigate to that page. See Navigation section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>search&lt;/td>
&lt;td>Object&lt;/td>
&lt;td>Contains the configuration to filter data by using the search feature from the page&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>search.value&lt;/td>
&lt;td>String&lt;/td>
&lt;td>Search term&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>search.asserts&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Elements to assert once it has finished searching in the current page. Use to make sure all elements in the page have finished rendering. See Asserts section for more details.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>search.postTestPath&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Click path to navigate after the test has finished searching and the asserts has finished.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>postTestPath&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Click path to navigate after the test has finished. E.g. clicking on the back button to go back to the main list. It uses the same Navigation structure, see the Navigation section below for more details.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>relaunchApp&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Set true, to close and open the app before navigating to this page. This can make tests slower as the app needs to load the assets and data again.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4>Forms&lt;span class="hx-absolute -hx-mt-20" id="forms">&lt;/span>
&lt;a href="#forms" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Object containing the definition of forms to load, fill fields and asserts outcomes.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Property&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Mandatory&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>navigation&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Click path to navigate to that page. See Navigation section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>useFAB&lt;/td>
&lt;td>Boolean&lt;/td>
&lt;td>Whether to click on the floating action button to open the form before proceeding with the tests.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.asserts&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Elements to assert once it has finished navigating to the current page. Use to make sure all elements in the page have finished rendering. See Asserts section for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.fields&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Fields to fill-up. See Fields section below for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.scrollDown&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll down to reach to the page buttons.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>pages.scrollUp&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll up in the page.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>postSubmitAsserts&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Elements to assert once it has finished submitting the form. Use to make sure the form was submitted correctly. Same as Asserts, see Asserts section for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>postTestPath&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Click path to navigate after the test has finished. E.g. clicking on the back button to go back to the main list. It uses the same Navigation structure, see the Navigation section below for more details.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4>Fields&lt;span class="hx-absolute -hx-mt-20" id="fields">&lt;/span>
&lt;a href="#fields" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Object containing the information to fill up fields.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Property&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Mandatory&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>selector&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element and clicks on it. Use it to select radio buttons or checkboxes; to activate a input text to open a keyboard; or to open a dropdown.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>keycodes&lt;/td>
&lt;td>Number[]&lt;/td>
&lt;td>Array of keycodes. Use it when you need to type in the phone&amp;rsquo;s keyboard, find the keycodes here: &lt;a href="https://developer.android.com/reference/android/view/KeyEvent" target="_blank" rel="noopener">https://developer.android.com/reference/android/view/KeyEvent&lt;/a>&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>dropdownOption&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to a dropdown option and clicks on it.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>value&lt;/td>
&lt;td>String or Number&lt;/td>
&lt;td>Use this to set the value directly in the input instead of using the keyboard. Like when using &lt;code>element.setValue()&lt;/code>.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>scrollDown&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll down to reach to the element specified in the &amp;ldquo;selector&amp;rdquo;.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>scrollUp&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll up to reach to the element specified in the &amp;ldquo;selector&amp;rdquo;.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>id&lt;/td>
&lt;td>String&lt;/td>
&lt;td>When having too many fields, use the id to label your fields and help you understand better the settings file.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4>Navigation&lt;span class="hx-absolute -hx-mt-20" id="navigation">&lt;/span>
&lt;a href="#navigation" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Object containing the click path to navigate to a page.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Property&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Mandatory&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>selector&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element and clicks on it.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>asserts&lt;/td>
&lt;td>Object[]&lt;/td>
&lt;td>Elements to assert once it has finished navigating. Use to make sure all elements in the page have finished rendering. See Asserts section for more details.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>scrollDown&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll down to reach to the element specified in the &amp;ldquo;selector&amp;rdquo;.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>scrollUp&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll up to reach to the element specified in the &amp;ldquo;selector&amp;rdquo;.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h4>Asserts&lt;span class="hx-absolute -hx-mt-20" id="asserts">&lt;/span>
&lt;a href="#asserts" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h4>&lt;p>Elements to assert that are displayed in the screen.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr>
&lt;th>Property&lt;/th>
&lt;th>Type&lt;/th>
&lt;th>Description&lt;/th>
&lt;th>Mandatory&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr>
&lt;td>selector&lt;/td>
&lt;td>String&lt;/td>
&lt;td>XPath selector to element and clicks on it.&lt;/td>
&lt;td>Yes&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>scrollDown&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll down to reach to the element specified in the &amp;ldquo;selector&amp;rdquo;.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;tr>
&lt;td>scrollUp&lt;/td>
&lt;td>Number&lt;/td>
&lt;td>Times to scroll up to reach to the element specified in the &amp;ldquo;selector&amp;rdquo;.&lt;/td>
&lt;td>No&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;h2>Tips&lt;span class="hx-absolute -hx-mt-20" id="tips">&lt;/span>
&lt;a href="#tips" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;ul>
&lt;li>
&lt;p>Take time to understand the forms you are testing:&lt;/p>
&lt;ul>
&lt;li>Are fields appearing dynamically?&lt;/li>
&lt;li>Are there field&amp;rsquo;s labels being updated automatically and removing the previous selection?&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>Assert for elements in the screen before interacting with them, to ensure they are ready.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Test how many scrolls you need by plugging the phone in the computer and run these adb commands:&lt;/p>
&lt;ul>
&lt;li>Scroll down: &lt;code>adb shell input swipe 500 1000 300 300&lt;/code>&lt;/li>
&lt;li>Scroll up: &lt;code>adb shell input swipe 300 300 500 1000&lt;/code>&lt;/li>
&lt;li>For example, if you need to run the scroll down command 3 times, then you add 3 as the value for scrollDown like this: &lt;code>&amp;quot;scrollDown&amp;quot;: 3,&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>In some cases, it&amp;rsquo;s necessary to unfocus a selected element, trigger a click in a label. For example:&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-json" data-lang="json">&lt;span class="line">&lt;span class="cl">&lt;span class="p">{&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;id&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;age_field_label&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl"> &lt;span class="nt">&amp;#34;selector&amp;#34;&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="s2">&amp;#34;//*[contains(@text, \&amp;#34;What is your age\&amp;#34;)]&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="p">}&lt;/span>&lt;span class="err">,&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;ul>
&lt;li>XPATH selectors
&lt;ul>
&lt;li>Avoid XPATH selector with special characters like single quote, asterisks.&lt;/li>
&lt;li>Find an element containing a text &lt;em>anywhere&lt;/em> on the screen: &lt;code>&amp;quot;//*[text()[contains(.,\&amp;quot;Eric Patt\&amp;quot;)]&amp;quot;&lt;/code>&lt;/li>
&lt;li>Use &lt;a href="https://github.com/appium/appium-inspector" target="_blank" rel="noopener">Appium Inspector&lt;/a> to help you find the XPath selectors. Sometimes it produces very long selectors but you can find a way to make them shorter.
&lt;ul>
&lt;li>If it fails to start after setting up with capabilities, try running appium server with the &lt;code>appium&lt;/code> command in the terminal before starting the Appium Inspector.&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ul></description></item><item><title>Developing on Windows</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/using-windows/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/using-windows/</guid><description>
&lt;p>We don&amp;rsquo;t actively support development on Windows, instead preferring MacOS or Linux.&lt;/p>
&lt;p>However, Microsoft has recently been stabilizing their &lt;a href="https://docs.microsoft.com/en-us/windows/wsl/about" target="_blank" rel="noopener">Windows Subsystem for Linux&lt;/a>, which appears to work reasonably well for development.&lt;/p>
&lt;p>Installation instructions are mostly the same as they written in &lt;a href="https://github.com/medic/cht-core/blob/master/README.md" target="_blank" rel="noopener">the README&lt;/a> with a couple of caveats as of time of writing (2019-07-25), noted below.&lt;/p>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200">
&lt;p class="hx-flex hx-items-center hx-font-medium">&lt;svg height=16px class="hx-inline-block hx-align-middle hx-mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>&lt;/svg>Note&lt;/p>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>Both the Windows Subsystem for Linux and Medic&amp;rsquo;s support for developing in it is very much in beta. These are advanced instructions, expect some understanding of linux and may not always work. Be patient and raise bugs as you find them!&lt;/p>&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2>Installing Ubuntu in the Windows Subsystem for Linux.&lt;span class="hx-absolute -hx-mt-20" id="installing-ubuntu-in-the-windows-subsystem-for-linux">&lt;/span>
&lt;a href="#installing-ubuntu-in-the-windows-subsystem-for-linux" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>For the rest of this document we&amp;rsquo;re going to presume that you&amp;rsquo;re using Ubuntu (18.04) in WSL. Medic probably works on all distributions, but Ubuntu is likely the best supported.&lt;/p>
&lt;p>First, follow Microsoft&amp;rsquo;s &lt;a href="https://docs.microsoft.com/en-us/windows/wsl/install-win10" target="_blank" rel="noopener">instructions on enabling and installing linux&lt;/a>. At the end of this process you should have a linux terminal.&lt;/p>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-blue-200 hx-bg-blue-100 hx-text-blue-900 dark:hx-border-blue-200/30 dark:hx-bg-blue-900/30 dark:hx-text-blue-200">
&lt;p class="hx-flex hx-items-center hx-font-medium">&lt;svg height=16px class="hx-inline-block hx-align-middle hx-mr-2" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true">&lt;path stroke-linecap="round" stroke-linejoin="round" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>&lt;/svg>Note&lt;/p>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">&lt;p>For the rest of this tutorial &lt;strong>in linux&lt;/strong> means code executing or performing actions in the WSL, while &lt;strong>in Windows&lt;/strong> means code executing or performing actions in Windows natively.&lt;/p>&lt;/div>
&lt;/div>
&lt;/div>
&lt;h2>CouchDB&lt;span class="hx-absolute -hx-mt-20" id="couchdb">&lt;/span>
&lt;a href="#couchdb" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>As of writing CouchDB wouldn&amp;rsquo;t autostart (due to systemd not existing?), and wasn&amp;rsquo;t manually starting due to erlang errors.&lt;/p>
&lt;p>Luckily, there is a perfectly working CouchDB installation for Windows:&lt;/p>
&lt;ul>
&lt;li>Download from &lt;a href="https://couchdb.apache.org/#download" target="_blank" rel="noopener">CouchDB&lt;/a> and install the Windows version. This will create a Windows service.&lt;/li>
&lt;li>Run it either by directly executing &lt;code>C:\CouchDB\bin\couchdb.cmd&lt;/code> or by starting the service&lt;/li>
&lt;/ul>
&lt;p>Then go to &lt;code>http://localhost:5984/_utils/#/setup&lt;/code> in Windows and do the single node setup. Once done head back to linux and confirm it works:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$: curl http://localhost:5984/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;couchdb&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;Welcome&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;version&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;2.3.1&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;git_sha&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;c298091a4&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;uuid&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;5f60350abaaa11c0131a5630e83ae979&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;features&amp;#34;&lt;/span>:&lt;span class="o">[&lt;/span>&lt;span class="s2">&amp;#34;pluggable-storage-engines&amp;#34;&lt;/span>,&lt;span class="s2">&amp;#34;scheduler&amp;#34;&lt;/span>&lt;span class="o">]&lt;/span>,&lt;span class="s2">&amp;#34;vendor&amp;#34;&lt;/span>:&lt;span class="o">{&lt;/span>&lt;span class="s2">&amp;#34;name&amp;#34;&lt;/span>:&lt;span class="s2">&amp;#34;The Apache Software Foundation&amp;#34;&lt;/span>&lt;span class="o">}}&lt;/span>&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Installing NPM&lt;span class="hx-absolute -hx-mt-20" id="installing-npm">&lt;/span>
&lt;a href="#installing-npm" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Start your WSL instance (Ubuntu), not WSL as they take you to two different default directories.&lt;/p>
&lt;p>The default &lt;code>npm&lt;/code> in linux is really old and doesn&amp;rsquo;t have &lt;code>npm ci&lt;/code>, which we need.&lt;/p>
&lt;p>Instead use &lt;a href="https://github.com/nvm-sh/nvm" target="_blank" rel="noopener">nvm&lt;/a> to install &lt;code>nvm install 11.3&lt;/code> .&lt;/p>
&lt;h2>Checking out the code&lt;span class="hx-absolute -hx-mt-20" id="checking-out-the-code">&lt;/span>
&lt;a href="#checking-out-the-code" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>We used git that&amp;rsquo;s preinstalled with Ubuntu to check out the code.&lt;/p>
&lt;p>You can checkout cht code inside WSL itself. You can checkout anywhere you have write access. We&amp;rsquo;ll checkout inside /home/username/medic directory.&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$: mkdir ~/medic &lt;span class="o">&amp;amp;&amp;amp;&lt;/span> &lt;span class="nb">cd&lt;/span> ~/medic
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$: git clone https://github.com/medic/cht-core.git&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Setup Environment Variables&lt;span class="hx-absolute -hx-mt-20" id="setup-environment-variables">&lt;/span>
&lt;a href="#setup-environment-variables" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>Using &lt;code>.bashrc&lt;/code> works as expected, and so is a good place to put exports:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">&lt;span class="c1"># Medic stuff&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">COUCH_URL&lt;/span>&lt;span class="o">=&lt;/span>http://admin:pass@localhost:5984/medic
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">&lt;span class="nb">export&lt;/span> &lt;span class="nv">COUCH_NODE_NAME&lt;/span>&lt;span class="o">=&lt;/span>couchdb@localhost&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Everything else&lt;span class="hx-absolute -hx-mt-20" id="everything-else">&lt;/span>
&lt;a href="#everything-else" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>&lt;code>npm ci&lt;/code> should just work once you&amp;rsquo;ve installed a latest version of node via nvm as noted above.&lt;/p>
&lt;p>Also install xstproc in your WSL:&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$: sudo apt-get update
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$: sudo apt-get install xsltproc&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>Now you can build the web app.&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$: &lt;span class="nb">cd&lt;/span> ~/medic/cht-core/
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$: npm ci
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$: npm run build-dev-watch&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;p>From this point, follow the &lt;code>harden couch&lt;/code> section in &lt;a href="https://docs.communityhealthtoolkit.org/community/contributing/code/core/dev-environment/#cht-core-cloning-and-setup" >Core Developer Setup&lt;/a>.&lt;/p>
&lt;p>To get multiple linux terminals (so you can run &lt;code>npm run&lt;/code>, &lt;code>api&lt;/code> and &lt;code>sentinel&lt;/code> at the same time) either install and use something like Tmux, or if you click &lt;code>Ubuntu&lt;/code> in the Windows start menu again it will open up a new terminal in the same linux instance.&lt;/p>
&lt;p>Once you&amp;rsquo;re done with the default instructions and have api running, check if it works by going to http://localhost:5988 in Chrome or Firefox.&lt;/p>
&lt;h2>Editing Code&lt;span class="hx-absolute -hx-mt-20" id="editing-code">&lt;/span>
&lt;a href="#editing-code" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>If you want to make changes to your code or contribute to our community health toolkit, you can do so by editing code from your favorite editor. If you editor supports UNC path, you can access and edit files inside WSL from &lt;code>\\wsl$\Ubuntu\&amp;lt;cht-core-location&amp;gt;&lt;/code>. If you use Visual Studio Code, it&amp;rsquo;s even easier to edit your code. Just navigate to where you have checked out cht-core and type &lt;code>code .&lt;/code> This will download VS Code Server for Ubuntu and open the project in Visual Studio Code in windows.&lt;/p>
&lt;div class="hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code">
&lt;div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="cl">$: &lt;span class="nb">cd&lt;/span> ~/medic/cht-core
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="cl">$: code .&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/div>&lt;div class="hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0">
&lt;button
class="hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50"
title="Copy code"
>
&lt;div class="copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;div class="success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4">&lt;/div>
&lt;/button>
&lt;/div>
&lt;/div>
&lt;h2>Default port and credentials for cht-core web&lt;span class="hx-absolute -hx-mt-20" id="default-port-and-credentials-for-cht-core-web">&lt;/span>
&lt;a href="#default-port-and-credentials-for-cht-core-web" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>The default launch port for cht-core is 5988, which can be changed by providing the environment variable at runtime &lt;code>API_PORT&lt;/code>, for example: &lt;code>API_PORT=6000 node server.js&lt;/code>.&lt;/p>
&lt;p>The deployed web app&amp;rsquo;s default user name and password is the username and password we set for CouchDB in the initial steps.&lt;/p>
&lt;h2>Problems?&lt;span class="hx-absolute -hx-mt-20" id="problems">&lt;/span>
&lt;a href="#problems" class="subheading-anchor" aria-label="Permalink for this section">&lt;/a>&lt;/h2>&lt;p>As none of CHT maintainers use Windows as a development environment daily this solution may not be as stable as directly using MacOS or Linux. If you encounter issues let a developer know&lt;/p></description></item><item><title>Running multiple Chrome versions</title><link>https://docs.communityhealthtoolkit.org/community/contributing/code/core/run-multiple-chrome-versions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://docs.communityhealthtoolkit.org/community/contributing/code/core/run-multiple-chrome-versions/</guid><description>
&lt;div class="hx-overflow-x-auto hx-mt-6 hx-flex hx-rounded-lg hx-border hx-py-2 ltr:hx-pr-4 rtl:hx-pl-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-orange-100 hx-bg-orange-50 hx-text-orange-800 dark:hx-border-orange-400/30 dark:hx-bg-orange-400/20 dark:hx-text-orange-300">
&lt;div class="ltr:hx-pl-3 ltr:hx-pr-2 rtl:hx-pr-3 rtl:hx-pl-2">&lt;/div>
&lt;div class="hx-w-full hx-min-w-0 hx-leading-7">
&lt;div class="hx-mt-6 hx-leading-7 first:hx-mt-0">These steps are suitable for Mac. They were tested in a Mac Intel. They can be adapted to any Chrome version.&lt;/div>
&lt;/div>
&lt;/div>
&lt;p>Follow these steps on a Mac to run Chrome version 90 while having another Chrome app on a different version.&lt;/p>
&lt;ul>
&lt;li>Download Chrome &lt;code>90.0.4430.72&lt;/code> from &lt;a href="https://www.slimjet.com/chrome/google-chrome-old-version.php?cmtx_sort=" target="_blank" rel="noopener">slimjet&lt;/a>&lt;/li>
&lt;li>Do not install the &lt;code>Google Chrome.app&lt;/code> in your &lt;code>Application&lt;/code> folder. Install it in your &lt;code>Desktop&lt;/code> folder for example.&lt;/li>
&lt;li>Change the name of the app to &lt;code>Google Chrome 90.app&lt;/code> and then move it to the &lt;code>Application&lt;/code> folder, &lt;em>&lt;strong>without&lt;/strong>&lt;/em> overwriting your current Chrome&lt;/li>
&lt;li>Remove Chromeâ€™s automatic updates by:
&lt;ul>
&lt;li>Close all Chrome open instances.&lt;/li>
&lt;li>Open &lt;code>Google Chrome 90.app&lt;/code> while not having Internet, so it doesn&amp;rsquo;t give an error after modifying the &lt;code>Info.plis&lt;/code>.&lt;/li>
&lt;li>Right-click on &lt;code>Application/Google Chrome 90.app&lt;/code>&lt;/li>
&lt;li>Click on &lt;code>Show package content&lt;/code>&lt;/li>
&lt;li>Open the file &lt;code>Contents/Info.plist&lt;/code> in your IDE&lt;/li>
&lt;li>Find the key &lt;code>KSUpdateURL&lt;/code>&lt;/li>
&lt;li>Replace the string below: &lt;string>&lt;a href="https://tools.google.com/service/update2" target="_blank" rel="noopener">https://tools.google.com/service/update2&lt;/a>&lt;/string> to &lt;string>&lt;a href="https://tools.google.com/[DUMMYTEXT]" target="_blank" rel="noopener">https://tools.google.com/[DUMMYTEXT]&lt;/a>&lt;/string>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>Run &lt;code>Google Chrome 90.app&lt;/code> as long as itâ€™s the only one running&lt;/li>
&lt;/ul></description></item></channel></rss>